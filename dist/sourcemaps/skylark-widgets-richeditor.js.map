{"version":3,"sources":["skylark-widgets-richeditor.js"],"names":["define","exports","module","__isValidToReturn","obj","Array","isArray","attr","__isEmptyObject","langx","$","editable","Toolbar","uploader","i18n","RichEditor","Evented","inherit","init","opts","editor","uploadOpts","this","extend","textarea","placeholder","length","Error","data","destroy","id","count","_render","self","el","classPrefix","body","on","e","trigger","type","upload","toolbar","toolbarFloat","toolbarHidden","toolbarFloatOffset","_placeholder","setValue","val","trim","focus","prototype","triggerHandler","args","concat","apply","defaultImage","params","_tpl","key","ref","results","insertBefore","wrapper","find","placeholderEl","append","blur","push","name","value","insertAfter","children","util","isEmptyNode","parseInt","css","indentWidth","show","hide","hidePopover","getValue","each","i","popover","active","closest","off","selection","clear","inputManager","focused","removeData","remove","document","window","zh-CN","blockquote","bold","code","color","coloredText","hr","image","externalImage","uploadImage","uploadFailed","uploadError","imageUrl","imageSize","imageAlt","restoreImageSize","uploading","indent","outdent","italic","link","linkText","linkUrl","linkTarget","openLinkInCurrentWindow","openLinkInNewWindow","removeLink","ol","ul","strikethrough","table","deleteRow","insertRowAbove","insertRowBelow","deleteColumn","insertColumnLeft","insertColumnRight","deleteTable","title","normalText","underline","alignment","alignCenter","alignLeft","alignRight","selectLanguage","fontScale","fontScaleXLarge","fontScaleLarge","fontScaleNormal","fontScaleSmall","fontScaleXSmall","en-US","translate","result","arguments","slice","call","locale","replace","p0","p","position","shift","Button","_init","item","menuWrapper","menuItem","separator","icon","text","htmlTag","disableTag","menu","disabled","needFocus","shortcut","k","len","tag","_this","render","noFocus","param","preventDefault","hasClass","toggleClass","siblings","removeClass","is","offset","left","outerWidth","right","command","btn","currentTarget","clipboard","pasting","setActive","setDisabled","hotkeys","add","mousedown","split","inArray","formatter","_allowedTags","_status","iconClassOf","setIcon","addClass","appendTo","list","renderMenu","$menuBtnEl","$menuItemEl","ref1","menuEl","data-param","_disableStatus","endNodes","startNodes","filter","_activeStatus","endNode","startNode","node","_t","Popover","button","top","target","_initLabelWidth","$fields","_labelWidth","field","$field","$label","Math","max","width","$target","refresh","reflow","editorOffset","maxLeft","targetH","targetOffset","outerHeight","height","min","floatInitialized","initToolbarFloat","toolbarHeight","os","mobile","bottomEdge","scrollTop","topEdge","buttons","pluginName","prependTo","constructor","findButton","addButton","AlignmentButton","align","end","status","BlockquoteButton","BoldButton","mac","isActive","CodePopover","lang","langs","codeLanguages","selectEl","selected","removeAttr","CodeButton","$el","pre","decorate","undecorate","_checkMode","range","cloneContents","blockNodes","join","collapsed","inlineMode","$pre","$code","match","contents","unwrap","wrapInner","_inlineCommand","_blockCommand","blockCode","inlineCode","ColorButton","$link","$p","hex","rgb","getComputedStyle","getPropertyValue","_convertRgbToHex","fontColor","exec","r","g","b","componentToHex","c","toString","rgbToHex","FontScaleButton","HrButton","ImagePopover","tpl","srcEl","widthEl","heightEl","altEl","which","createRange","setRangeAfter","_loadImage","_resizeImg","inputEl","$img","_restoreImg","alt","_initUploader","$uploadBtn","createInput","input","multiple","accept","stopPropagation","inline","img","onlySetVal","isNumber","size","src","callback","test","loadImage","blob","dataURLtoBlob","prop","ImageButton","imageButton","selectNode","support","onselectionchange","$contents","startContainer","eq","startOffset","$masks","mask","$mask","file","parent","cancel","$uploadItem","$input","uploadProgress","one","createImage","readImageFile","proxy","throttle","loaded","total","percent","toFixed","img_path","msg","JSON","parse","_error","success","alert","file_path","xhr","statusText","responseText","positionMask","imgOffset","wrapperOffset","Image","onload","data-image-size","isFunction","onerror","deleteContents","insertNode","click","select","IndentButton","hotkey","tabIndent","ItalicButton","LinkPopover","textEl","urlEl","unlinkEl","selectTarget","throttledValueChanged","shiftKey","txtNode","createTextNode","replaceWith","LinkButton","rangeAtEndOf","noder","ListButton","OrderListButton","OutdentButton","StrikethroughButton","dom","tables","TableButton","merge","_allowedAttributes","td","col","_allowedStyles","th","_initShortcuts","_initResize","$container","containerNode","setRangeAtEndOf","keystroke","$node","_tdNav","$td","direction","$anotherTr","$tr","action","index","resizable","cssClasses","resizeHandle","editMenu","$table","createMenu","createTable","$trs","num","prevAll","addBack","$closestBlock","colNum","rowNum","last","after","setRangeAtStartOf","tableDecorate","row","phBr","refreshTableWidth","ret","newTr","insertRow","deleteCol","newTd","insertCol","$block","TitleButton","tagName","toLowerCase","UnderlineButton","UnorderListButton","main"],"mappings":"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","file":"../skylark-widgets-richeditor.js","sourcesContent":["define([], function () {\n    'use strict';\n    var exports = {};\n    var module = { exports: {} };\n    define([\n        'skylark-langx/langx',\n        'skylark-utils-dom/query',\n        'skylark-domx-contents/editable',\n        './Toolbar',\n        './uploader',\n        './i18n'\n    ], function (langx, $, editable, Toolbar, uploader, i18n) {\n        var RichEditor = langx.Evented.inherit({\n            init: function (opts) {\n                this.opts = langx.extend({}, this.opts, opts);\n                var e, editor, uploadOpts;\n                this.textarea = $(this.opts.textarea);\n                this.opts.placeholder = this.opts.placeholder || this.textarea.attr('placeholder');\n                if (!this.textarea.length) {\n                    throw new Error('richeditor: param textarea is required.');\n                    return;\n                }\n                editor = this.textarea.data('richeditor');\n                if (editor != null) {\n                    editor.destroy();\n                }\n                this.id = ++RichEditor.count;\n                this._render();\n                var self = this;\n                this.editable = editable(this.el, {\n                    classPrefix: 'richeditor-',\n                    textarea: this.textarea,\n                    body: this.body\n                });\n                this.editable.on('all', function (e, data) {\n                    return self.trigger(e.type, data);\n                });\n                if (this.opts.upload && uploader) {\n                    uploadOpts = typeof this.opts.upload === 'object' ? this.opts.upload : {};\n                    this.uploader = uploader(uploadOpts);\n                }\n                this.toolbar = new Toolbar(this, {\n                    toolbar: this.opts.toolbar,\n                    toolbarFloat: this.opts.toolbarFloat,\n                    toolbarHidden: this.opts.toolbarHidden,\n                    toolbarFloatOffset: this.opts.toolbarFloatOffset\n                });\n                if (this.opts.placeholder) {\n                    this.on('valuechanged', function () {\n                        return self._placeholder();\n                    });\n                }\n                this.setValue(this.textarea.val().trim() || '');\n                if (this.textarea.attr('autofocus')) {\n                    return self.focus();\n                }\n            }\n        });\n        RichEditor.prototype.triggerHandler = RichEditor.prototype.trigger = function (type, data) {\n            var args, ref;\n            args = [type];\n            if (data) {\n                args = args.concat(data);\n            }\n            langx.Evented.prototype.trigger.apply(this, args);\n            return this;\n        };\n        RichEditor.count = 0;\n        RichEditor.prototype.opts = {\n            textarea: null,\n            placeholder: '',\n            defaultImage: 'images/image.png',\n            params: {},\n            upload: false\n        };\n        RichEditor.prototype._tpl = '<div class=\"richeditor\">\\n  <div class=\"richeditor-wrapper\">\\n    <div class=\"richeditor-placeholder\"></div>\\n    <div class=\"richeditor-body\" contenteditable=\"true\">\\n    </div>\\n  </div>\\n</div>';\n        RichEditor.prototype._render = function () {\n            var key, ref, results, val;\n            this.el = $(this._tpl).insertBefore(this.textarea);\n            this.wrapper = this.el.find('.richeditor-wrapper');\n            this.body = this.wrapper.find('.richeditor-body');\n            this.placeholderEl = this.wrapper.find('.richeditor-placeholder').append(this.opts.placeholder);\n            this.el.data('richeditor', this);\n            this.wrapper.append(this.textarea);\n            this.textarea.data('richeditor', this).blur();\n            this.body.attr('tabindex', this.textarea.attr('tabindex'));\n            if (this.opts.params) {\n                ref = this.opts.params;\n                results = [];\n                for (key in ref) {\n                    val = ref[key];\n                    results.push($('<input/>', {\n                        type: 'hidden',\n                        name: key,\n                        value: val\n                    }).insertAfter(this.textarea));\n                }\n                return results;\n            }\n        };\n        RichEditor.prototype._placeholder = function () {\n            var children;\n            children = this.body.children();\n            if (children.length === 0 || children.length === 1 && this.util.isEmptyNode(children) && parseInt(children.css('margin-left') || 0) < this.opts.indentWidth) {\n                return this.placeholderEl.show();\n            } else {\n                return this.placeholderEl.hide();\n            }\n        };\n        RichEditor.prototype.setValue = function (val) {\n            this.hidePopover();\n            this.editable.setValue(val);\n            return this.trigger('valuechanged');\n        };\n        RichEditor.prototype.getValue = function () {\n            return this.editable.getValue();\n        };\n        RichEditor.prototype.focus = function () {\n            return this.editable.focus();\n        };\n        RichEditor.prototype.blur = function () {\n            return this.editable.blur();\n        };\n        RichEditor.prototype.hidePopover = function () {\n            return this.el.find('.richeditor-popover').each(function (i, popover) {\n                popover = $(popover).data('popover');\n                if (popover.active) {\n                    return popover.hide();\n                }\n            });\n        };\n        RichEditor.prototype.destroy = function () {\n            this.triggerHandler('destroy');\n            this.textarea.closest('form').off('.richeditor .richeditor-' + this.id);\n            this.selection.clear();\n            this.inputManager.focused = false;\n            this.textarea.insertBefore(this.el).hide().val('').removeData('richeditor');\n            this.el.remove();\n            $(document).off('.richeditor-' + this.id);\n            $(window).off('.richeditor-' + this.id);\n            return this.off();\n        };\n        RichEditor.Toolbar = Toolbar;\n        RichEditor.i18n = i18n;\n        return RichEditor;\n    });\n    function __isEmptyObject(obj) {\n        var attr;\n        for (attr in obj)\n            return !1;\n        return !0;\n    }\n    function __isValidToReturn(obj) {\n        return typeof obj != 'object' || Array.isArray(obj) || !__isEmptyObject(obj);\n    }\n    if (__isValidToReturn(module.exports))\n        return module.exports;\n    else if (__isValidToReturn(exports))\n        return exports;\n});\ndefine(\"skylark-widgets-richeditor/RichEditor\", function(){});\n\ndefine('skylark-widgets-richeditor/i18n',[\r\n\r\n],function(){ \r\n\r\n    var i18n =  {\r\n      'zh-CN': {\r\n        'blockquote': '引用',\r\n        'bold': '加粗文字',\r\n        'code': '插入代码',\r\n        'color': '文字颜色',\r\n        'coloredText': '彩色文字',\r\n        'hr': '分隔线',\r\n        'image': '插入图片',\r\n        'externalImage': '外链图片',\r\n        'uploadImage': '上传图片',\r\n        'uploadFailed': '上传失败了',\r\n        'uploadError': '上传出错了',\r\n        'imageUrl': '图片地址',\r\n        'imageSize': '图片尺寸',\r\n        'imageAlt': '图片描述',\r\n        'restoreImageSize': '还原图片尺寸',\r\n        'uploading': '正在上传',\r\n        'indent': '向右缩进',\r\n        'outdent': '向左缩进',\r\n        'italic': '斜体文字',\r\n        'link': '插入链接',\r\n        'linkText': '链接文字',\r\n        'linkUrl': '链接地址',\r\n        'linkTarget': '打开方式',\r\n        'openLinkInCurrentWindow': '在当前窗口中打开',\r\n        'openLinkInNewWindow': '在新窗口中打开',\r\n        'removeLink': '移除链接',\r\n        'ol': '有序列表',\r\n        'ul': '无序列表',\r\n        'strikethrough': '删除线文字',\r\n        'table': '表格',\r\n        'deleteRow': '删除行',\r\n        'insertRowAbove': '在上面插入行',\r\n        'insertRowBelow': '在下面插入行',\r\n        'deleteColumn': '删除列',\r\n        'insertColumnLeft': '在左边插入列',\r\n        'insertColumnRight': '在右边插入列',\r\n        'deleteTable': '删除表格',\r\n        'title': '标题',\r\n        'normalText': '普通文本',\r\n        'underline': '下划线文字',\r\n        'alignment': '水平对齐',\r\n        'alignCenter': '居中',\r\n        'alignLeft': '居左',\r\n        'alignRight': '居右',\r\n        'selectLanguage': '选择程序语言',\r\n        'fontScale': '字体大小',\r\n        'fontScaleXLarge': '超大字体',\r\n        'fontScaleLarge': '大号字体',\r\n        'fontScaleNormal': '正常大小',\r\n        'fontScaleSmall': '小号字体',\r\n        'fontScaleXSmall': '超小字体'\r\n      },\r\n      'en-US': {\r\n        'blockquote': 'Block Quote',\r\n        'bold': 'Bold',\r\n        'code': 'Code',\r\n        'color': 'Text Color',\r\n        'coloredText': 'Colored Text',\r\n        'hr': 'Horizontal Line',\r\n        'image': 'Insert Image',\r\n        'externalImage': 'External Image',\r\n        'uploadImage': 'Upload Image',\r\n        'uploadFailed': 'Upload failed',\r\n        'uploadError': 'Error occurs during upload',\r\n        'imageUrl': 'Url',\r\n        'imageSize': 'Size',\r\n        'imageAlt': 'Alt',\r\n        'restoreImageSize': 'Restore Origin Size',\r\n        'uploading': 'Uploading',\r\n        'indent': 'Indent',\r\n        'outdent': 'Outdent',\r\n        'italic': 'Italic',\r\n        'link': 'Insert Link',\r\n        'linkText': 'Text',\r\n        'linkUrl': 'Url',\r\n        'linkTarget': 'Target',\r\n        'openLinkInCurrentWindow': 'Open link in current window',\r\n        'openLinkInNewWindow': 'Open link in new window',\r\n        'removeLink': 'Remove Link',\r\n        'ol': 'Ordered List',\r\n        'ul': 'Unordered List',\r\n        'strikethrough': 'Strikethrough',\r\n        'table': 'Table',\r\n        'deleteRow': 'Delete Row',\r\n        'insertRowAbove': 'Insert Row Above',\r\n        'insertRowBelow': 'Insert Row Below',\r\n        'deleteColumn': 'Delete Column',\r\n        'insertColumnLeft': 'Insert Column Left',\r\n        'insertColumnRight': 'Insert Column Right',\r\n        'deleteTable': 'Delete Table',\r\n        'title': 'Title',\r\n        'normalText': 'Text',\r\n        'underline': 'Underline',\r\n        'alignment': 'Alignment',\r\n        'alignCenter': 'Align Center',\r\n        'alignLeft': 'Align Left',\r\n        'alignRight': 'Align Right',\r\n        'selectLanguage': 'Select Language',\r\n        'fontScale': 'Font Size',\r\n        'fontScaleXLarge': 'X Large Size',\r\n        'fontScaleLarge': 'Large Size',\r\n        'fontScaleNormal': 'Normal Size',\r\n        'fontScaleSmall': 'Small Size',\r\n        'fontScaleXSmall': 'X Small Size'\r\n      },\r\n\r\n      translate : function() {\r\n        var args, key, ref, result;\r\n        key = arguments[0], args = 2 <= arguments.length ? Array.prototype.slice.call(arguments, 1) : [];\r\n        result = ((ref = i18n[this.locale]) != null ? ref[key] : void 0) || '';\r\n        if (!(args.length > 0)) {\r\n          return result;\r\n        }\r\n        result = result.replace(/([^%]|^)%(?:(\\d+)\\$)?s/g, function(p0, p, position) {\r\n          if (position) {\r\n            return p + args[parseInt(position) - 1];\r\n          } else {\r\n            return p + args.shift();\r\n          }\r\n        });\r\n        return result.replace(/%%s/g, '%s');\r\n      }\r\n\r\n    };\r\n\r\n    return i18n;\r\n});\ndefine('skylark-widgets-richeditor/Button',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-utils-dom/query\",\r\n  \"./RichEditor\",\r\n  \"./i18n\"\r\n],function(langx, $,RichEditor,i18n){ \r\n  var slice = [].slice;\r\n\r\n  var Button = langx.Evented.inherit( {\r\n    init : function(opts) {\r\n      this.toolbar = opts.toolbar;\r\n      this.editor = opts.toolbar.editor;\r\n      this.title = i18n.translate(this.name);\r\n      this._init();\r\n    }\r\n  }); \r\n\r\n  Button.prototype._tpl = {\r\n    item: '<li><a tabindex=\"-1\" unselectable=\"on\" class=\"toolbar-item\" href=\"javascript:;\"><span></span></a></li>',\r\n    menuWrapper: '<div class=\"toolbar-menu\"></div>',\r\n    menuItem: '<li><a tabindex=\"-1\" unselectable=\"on\" class=\"menu-item\" href=\"javascript:;\"><span></span></a></li>',\r\n    separator: '<li><span class=\"separator\"></span></li>'\r\n  };\r\n\r\n  Button.prototype.name = '';\r\n\r\n  Button.prototype.icon = '';\r\n\r\n  Button.prototype.title = '';\r\n\r\n  Button.prototype.text = '';\r\n\r\n  Button.prototype.htmlTag = '';\r\n\r\n  Button.prototype.disableTag = '';\r\n\r\n  Button.prototype.menu = false;\r\n\r\n  Button.prototype.active = false;\r\n\r\n  Button.prototype.disabled = false;\r\n\r\n  Button.prototype.needFocus = true;\r\n\r\n  Button.prototype.shortcut = null;\r\n\r\n\r\n  Button.prototype._init = function() {\r\n    var k, len, ref, tag;\r\n    this.render();\r\n    this.el.on('mousedown', (function(_this) {\r\n      return function(e) {\r\n        var exceed, noFocus, param;\r\n        e.preventDefault();\r\n        noFocus = _this.needFocus && !_this.editor.editable.inputManager.focused;\r\n        if (_this.el.hasClass('disabled')) {\r\n          return false;\r\n        }\r\n        if (noFocus) {\r\n          _this.editor.focus();\r\n        }\r\n        if (_this.menu) {\r\n          _this.wrapper.toggleClass('menu-on').siblings('li').removeClass('menu-on');\r\n          if (_this.wrapper.is('.menu-on')) {\r\n            exceed = _this.menuWrapper.offset().left + _this.menuWrapper.outerWidth() + 5 - _this.editor.wrapper.offset().left - _this.editor.wrapper.outerWidth();\r\n            if (exceed > 0) {\r\n              _this.menuWrapper.css({\r\n                'left': 'auto',\r\n                'right': 0\r\n              });\r\n            }\r\n            _this.trigger('menuexpand');\r\n          }\r\n          return false;\r\n        }\r\n        param = _this.el.data('param');\r\n        _this.command(param);\r\n        return false;\r\n      };\r\n    })(this));\r\n    this.wrapper.on('click', 'a.menu-item', (function(_this) {\r\n      return function(e) {\r\n        var btn, noFocus, param;\r\n        e.preventDefault();\r\n        btn = $(e.currentTarget);\r\n        _this.wrapper.removeClass('menu-on');\r\n        noFocus = _this.needFocus && !_this.editor.editable.inputManager.focused;\r\n        if (btn.hasClass('disabled') || noFocus) {\r\n          return false;\r\n        }\r\n        _this.toolbar.wrapper.removeClass('menu-on');\r\n        param = btn.data('param');\r\n        _this.command(param);\r\n        return false;\r\n      };\r\n    })(this));\r\n    this.wrapper.on('mousedown', 'a.menu-item', function(e) {\r\n      return false;\r\n    });\r\n    this.editor.on('blur', (function(_this) {\r\n      return function() {\r\n        var editorActive;\r\n        editorActive = _this.editor.body.is(':visible') && _this.editor.body.is('[contenteditable]');\r\n        if (!(editorActive && !_this.editor.editable.clipboard.pasting)) {\r\n          return;\r\n        }\r\n        _this.setActive(false);\r\n        return _this.setDisabled(false);\r\n      };\r\n    })(this));\r\n    if (this.shortcut != null) {\r\n      this.editor.editable.hotkeys.add(this.shortcut, (function(_this) {\r\n        return function(e) {\r\n          _this.el.mousedown();\r\n          return false;\r\n        };\r\n      })(this));\r\n    }\r\n    ref = this.htmlTag.split(',');\r\n    for (k = 0, len = ref.length; k < len; k++) {\r\n      tag = ref[k];\r\n      tag = langx.trim(tag);\r\n      if (tag && langx.inArray(tag, this.editor.editable.formatter._allowedTags) < 0) {\r\n        this.editor.editable.formatter._allowedTags.push(tag);\r\n      }\r\n    }\r\n    return this.editor.on('selectionchanged', (function(_this) {\r\n      return function(e) {\r\n        if (_this.editor.editable.inputManager.focused) {\r\n          return _this._status();\r\n        }\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  Button.prototype.iconClassOf = function(icon) {\r\n    if (icon) {\r\n      return \"richeditor-icon richeditor-icon-\" + icon;\r\n    } else {\r\n      return '';\r\n    }\r\n  };\r\n\r\n  Button.prototype.setIcon = function(icon) {\r\n    return this.el.find('span').removeClass().addClass(this.iconClassOf(icon)).text(this.text);\r\n  };\r\n\r\n  Button.prototype.render = function() {\r\n    this.wrapper = $(this._tpl.item).appendTo(this.toolbar.list);\r\n    this.el = this.wrapper.find('a.toolbar-item');\r\n    this.el.attr('title', this.title).addClass(\"toolbar-item-\" + this.name).data('button', this);\r\n    this.setIcon(this.icon);\r\n    if (!this.menu) {\r\n      return;\r\n    }\r\n    this.menuWrapper = $(this._tpl.menuWrapper).appendTo(this.wrapper);\r\n    this.menuWrapper.addClass(\"toolbar-menu-\" + this.name);\r\n    return this.renderMenu();\r\n  };\r\n\r\n  Button.prototype.renderMenu = function() {\r\n    var $menuBtnEl, $menuItemEl, k, len, menuItem, ref, ref1, results;\r\n    if (!langx.isArray(this.menu)) {\r\n      return;\r\n    }\r\n    this.menuEl = $('<ul/>').appendTo(this.menuWrapper);\r\n    ref = this.menu;\r\n    results = [];\r\n    for (k = 0, len = ref.length; k < len; k++) {\r\n      menuItem = ref[k];\r\n      if (menuItem === '|') {\r\n        $(this._tpl.separator).appendTo(this.menuEl);\r\n        continue;\r\n      }\r\n      $menuItemEl = $(this._tpl.menuItem).appendTo(this.menuEl);\r\n      $menuBtnEl = $menuItemEl.find('a.menu-item').attr({\r\n        'title': (ref1 = menuItem.title) != null ? ref1 : menuItem.text,\r\n        'data-param': menuItem.param\r\n      }).addClass('menu-item-' + menuItem.name);\r\n      if (menuItem.icon) {\r\n        results.push($menuBtnEl.find('span').addClass(this.iconClassOf(menuItem.icon)));\r\n      } else {\r\n        results.push($menuBtnEl.find('span').text(menuItem.text));\r\n      }\r\n    }\r\n    return results;\r\n  };\r\n\r\n  Button.prototype.setActive = function(active) {\r\n    if (active === this.active) {\r\n      return;\r\n    }\r\n    this.active = active;\r\n    return this.el.toggleClass('active', this.active);\r\n  };\r\n\r\n  Button.prototype.setDisabled = function(disabled) {\r\n    if (disabled === this.disabled) {\r\n      return;\r\n    }\r\n    this.disabled = disabled;\r\n    return this.el.toggleClass('disabled', this.disabled);\r\n  };\r\n\r\n  Button.prototype._disableStatus = function() {\r\n    var disabled, endNodes, startNodes;\r\n    startNodes = this.editor.editable.selection.startNodes();\r\n    endNodes = this.editor.editable.selection.endNodes();\r\n    disabled = startNodes.filter(this.disableTag).length > 0 || endNodes.filter(this.disableTag).length > 0;\r\n    this.setDisabled(disabled);\r\n    if (this.disabled) {\r\n      this.setActive(false);\r\n    }\r\n    return this.disabled;\r\n  };\r\n\r\n  Button.prototype._activeStatus = function() {\r\n    var active, endNode, endNodes, startNode, startNodes;\r\n    startNodes = this.editor.editable.selection.startNodes();\r\n    endNodes = this.editor.editable.selection.endNodes();\r\n    startNode = startNodes.filter(this.htmlTag);\r\n    endNode = endNodes.filter(this.htmlTag);\r\n    active = startNode.length > 0 && endNode.length > 0 && startNode.is(endNode);\r\n    this.node = active ? startNode : null;\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  Button.prototype._status = function() {\r\n    this._disableStatus();\r\n    if (this.disabled) {\r\n      return;\r\n    }\r\n    return this._activeStatus();\r\n  };\r\n\r\n  Button.prototype.command = function(param) {};\r\n\r\n  Button.prototype._t = i18n.translate;\r\n  \r\n\r\n  RichEditor.Button = Button;\r\n\r\n  return Button;\r\n});\ndefine('skylark-widgets-richeditor/Popover',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-utils-dom/query\",\r\n  \"./RichEditor\",\r\n  \"./i18n\"\r\n],function(langx,$,RichEditor,i18n){ \r\n\r\n  var Popover = langx.Evented.inherit({\r\n     init : function(opts) {\r\n      this.button = opts.button;\r\n      this.editor = opts.button.editor;\r\n      this._init();\r\n    }\r\n  });\r\n\r\n\r\n  Popover.prototype.offset = {\r\n    top: 4,\r\n    left: 0\r\n  };\r\n\r\n  Popover.prototype.target = null;\r\n\r\n  Popover.prototype.active = false;\r\n\r\n  Popover.prototype._init = function() {\r\n    this.el = $('<div class=\"richeditor-popover\"></div>').appendTo(this.editor.el).data('popover', this);\r\n    this.render();\r\n    this.el.on('mouseenter', (function(_this) {\r\n      return function(e) {\r\n        return _this.el.addClass('hover');\r\n      };\r\n    })(this));\r\n    return this.el.on('mouseleave', (function(_this) {\r\n      return function(e) {\r\n        return _this.el.removeClass('hover');\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  Popover.prototype.render = function() {};\r\n\r\n  Popover.prototype._initLabelWidth = function() {\r\n    var $fields;\r\n    $fields = this.el.find('.settings-field');\r\n    if (!($fields.length > 0)) {\r\n      return;\r\n    }\r\n    this._labelWidth = 0;\r\n    $fields.each((function(_this) {\r\n      return function(i, field) {\r\n        var $field, $label;\r\n        $field = $(field);\r\n        $label = $field.find('label');\r\n        if (!($label.length > 0)) {\r\n          return;\r\n        }\r\n        return _this._labelWidth = Math.max(_this._labelWidth, $label.width());\r\n      };\r\n    })(this));\r\n    return $fields.find('label').width(this._labelWidth);\r\n  };\r\n\r\n  Popover.prototype.show = function($target, position) {\r\n    if (position == null) {\r\n      position = 'bottom';\r\n    }\r\n    if ($target == null) {\r\n      return;\r\n    }\r\n    this.el.siblings('.richeditor-popover').each(function(i, popover) {\r\n      popover = $(popover).data('popover');\r\n      if (popover.active) {\r\n        return popover.hide();\r\n      }\r\n    });\r\n    if (this.active && this.target) {\r\n      this.target.removeClass('selected');\r\n    }\r\n    this.target = $target.addClass('selected');\r\n    if (this.active) {\r\n      this.refresh(position);\r\n      return this.trigger('popovershow');\r\n    } else {\r\n      this.active = true;\r\n      this.el.css({\r\n        left: -9999\r\n      }).show();\r\n      if (!this._labelWidth) {\r\n        this._initLabelWidth();\r\n      }\r\n      this.editor.editable.util.reflow();\r\n      this.refresh(position);\r\n      return this.trigger('popovershow');\r\n    }\r\n  };\r\n\r\n  Popover.prototype.hide = function() {\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n    if (this.target) {\r\n      this.target.removeClass('selected');\r\n    }\r\n    this.target = null;\r\n    this.active = false;\r\n    this.el.hide();\r\n    return this.trigger('popoverhide');\r\n  };\r\n\r\n  Popover.prototype.refresh = function(position) {\r\n    var editorOffset, left, maxLeft, targetH, targetOffset, top;\r\n    if (position == null) {\r\n      position = 'bottom';\r\n    }\r\n    if (!this.active) {\r\n      return;\r\n    }\r\n    editorOffset = this.editor.el.offset();\r\n    targetOffset = this.target.offset();\r\n    targetH = this.target.outerHeight();\r\n    if (position === 'bottom') {\r\n      top = targetOffset.top - editorOffset.top + targetH;\r\n    } else if (position === 'top') {\r\n      top = targetOffset.top - editorOffset.top - this.el.height();\r\n    }\r\n    maxLeft = this.editor.wrapper.width() - this.el.outerWidth() - 10;\r\n    left = Math.min(targetOffset.left - editorOffset.left, maxLeft);\r\n    return this.el.css({\r\n      top: top + this.offset.top,\r\n      left: left + this.offset.left\r\n    });\r\n  };\r\n\r\n  Popover.prototype.destroy = function() {\r\n    this.target = null;\r\n    this.active = false;\r\n    this.editor.off('.linkpopover');\r\n    return this.el.remove();\r\n  };\r\n\r\n  Popover.prototype._t = function(name) {\r\n    var args, ref, result;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    result = i18n.translate.apply(i18n, args);\r\n    return result;\r\n  };\r\n\r\n  RichEditor.Popover = Popover;\r\n\r\n  return Popover;\r\n\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/Toolbar',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-utils-dom/query\"\r\n],function(langx,$){ \r\n\r\n  var Toolbar = langx.Evented.inherit({\r\n    init : function(editor,opts) {\r\n      var floatInitialized, initToolbarFloat, toolbarHeight;\r\n      this.editor = editor;\r\n\r\n      this.opts = langx.extend({}, this.opts, opts);\r\n\r\n      if (!this.opts.toolbar) {\r\n        return;\r\n      }\r\n      if (!langx.isArray(this.opts.toolbar)) {\r\n        this.opts.toolbar = ['bold', 'italic', 'underline', 'strikethrough', '|', 'ol', 'ul', 'blockquote', 'code', '|', 'link', 'image', '|', 'indent', 'outdent'];\r\n      }\r\n      this._render();\r\n      this.list.on('click', function(e) {\r\n        return false;\r\n      });\r\n      this.wrapper.on('mousedown', (function(_this) {\r\n        return function(e) {\r\n          return _this.list.find('.menu-on').removeClass('.menu-on');\r\n        };\r\n      })(this));\r\n      $(document).on('mousedown.richeditor' + this.editor.id, (function(_this) {\r\n        return function(e) {\r\n          return _this.list.find('.menu-on').removeClass('.menu-on');\r\n        };\r\n      })(this));\r\n      if (!this.opts.toolbarHidden && this.opts.toolbarFloat) {\r\n        this.wrapper.css('top', this.opts.toolbarFloatOffset);\r\n        toolbarHeight = 0;\r\n        initToolbarFloat = (function(_this) {\r\n          return function() {\r\n            _this.wrapper.css('position', 'static');\r\n            _this.wrapper.width('auto');\r\n            _this.editor.editable.util.reflow(_this.wrapper);\r\n            _this.wrapper.width(_this.wrapper.outerWidth());\r\n            _this.wrapper.css('left', _this.editor.editable.util.os.mobile ? _this.wrapper.position().left : _this.wrapper.offset().left);\r\n            _this.wrapper.css('position', '');\r\n            toolbarHeight = _this.wrapper.outerHeight();\r\n            _this.editor.placeholderEl.css('top', toolbarHeight);\r\n            return true;\r\n          };\r\n        })(this);\r\n        floatInitialized = null;\r\n        $(window).on('resize.richeditor-' + this.editor.id, function(e) {\r\n          return floatInitialized = initToolbarFloat();\r\n        });\r\n        $(window).on('scroll.richeditor-' + this.editor.id, (function(_this) {\r\n          return function(e) {\r\n            var bottomEdge, scrollTop, topEdge;\r\n            if (!_this.wrapper.is(':visible')) {\r\n              return;\r\n            }\r\n            topEdge = _this.editor.wrapper.offset().top;\r\n            bottomEdge = topEdge + _this.editor.wrapper.outerHeight() - 80;\r\n            scrollTop = $(document).scrollTop() + _this.opts.toolbarFloatOffset;\r\n            if (scrollTop <= topEdge || scrollTop >= bottomEdge) {\r\n              _this.editor.wrapper.removeClass('toolbar-floating').css('padding-top', '');\r\n              if (_this.editor.editable.util.os.mobile) {\r\n                return _this.wrapper.css('top', _this.opts.toolbarFloatOffset);\r\n              }\r\n            } else {\r\n              floatInitialized || (floatInitialized = initToolbarFloat());\r\n              _this.editor.wrapper.addClass('toolbar-floating').css('padding-top', toolbarHeight);\r\n              if (_this.editor.editable.util.os.mobile) {\r\n                return _this.wrapper.css('top', scrollTop - topEdge + _this.opts.toolbarFloatOffset);\r\n              }\r\n            }\r\n          };\r\n        })(this));\r\n      }\r\n      this.editor.on('destroy', (function(_this) {\r\n        return function() {\r\n          return _this.buttons.length = 0;\r\n        };\r\n      })(this));\r\n      $(document).on(\"mousedown.richeditor-\" + this.editor.id, (function(_this) {\r\n        return function(e) {\r\n          return _this.list.find('li.menu-on').removeClass('menu-on');\r\n        };\r\n      })(this));\r\n    }\r\n\r\n  });\r\n\r\n  Toolbar.pluginName = 'Toolbar';\r\n\r\n  Toolbar.prototype.opts = {\r\n    toolbar: true,\r\n    toolbarFloat: true,\r\n    toolbarHidden: false,\r\n    toolbarFloatOffset: 0\r\n  };\r\n\r\n  Toolbar.prototype._tpl = {\r\n    wrapper: '<div class=\"richeditor-toolbar\"><ul></ul></div>',\r\n    separator: '<li><span class=\"separator\"></span></li>'\r\n  };\r\n\r\n\r\n  Toolbar.prototype._render = function() {\r\n    var k, len, name, ref;\r\n    this.buttons = [];\r\n    this.wrapper = $(this._tpl.wrapper).prependTo(this.editor.wrapper);\r\n    this.list = this.wrapper.find('ul');\r\n    ref = this.opts.toolbar;\r\n    for (k = 0, len = ref.length; k < len; k++) {\r\n      name = ref[k];\r\n      if (name === '|') {\r\n        $(this._tpl.separator).appendTo(this.list);\r\n        continue;\r\n      }\r\n      if (!this.constructor.buttons[name]) {\r\n        throw new Error(\"richeditor: invalid toolbar button \" + name);\r\n        continue;\r\n      }\r\n      this.buttons.push(new this.constructor.buttons[name]({\r\n        toolbar : this,\r\n        editor: this.editor\r\n      }));\r\n    }\r\n    if (this.opts.toolbarHidden) {\r\n      return this.wrapper.hide();\r\n    }\r\n  };\r\n\r\n  Toolbar.prototype.findButton = function(name) {\r\n    var button;\r\n    button = this.list.find('.toolbar-item-' + name).data('button');\r\n    return button != null ? button : null;\r\n  };\r\n\r\n  Toolbar.addButton = function(btn) {\r\n    return this.buttons[btn.prototype.name] = btn;\r\n  };\r\n\r\n  Toolbar.buttons = {};\r\n\r\n  return Toolbar;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/AlignmentButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,RichEditor,Button,i18n){ \r\n   var AlignmentButton = Button.inherit({\r\n\r\n    });\r\n\r\n\r\n  AlignmentButton.prototype.name = \"alignment\";\r\n\r\n  AlignmentButton.prototype.icon = 'align-left';\r\n\r\n  AlignmentButton.prototype.htmlTag = 'p, h1, h2, h3, h4, td, th';\r\n\r\n  AlignmentButton.prototype._init = function() {\r\n    this.menu = [\r\n      {\r\n        name: 'left',\r\n        text: i18n.translate('alignLeft'),\r\n        icon: 'align-left',\r\n        param: 'left'\r\n      }, {\r\n        name: 'center',\r\n        text: i18n.translate('alignCenter'),\r\n        icon: 'align-center',\r\n        param: 'center'\r\n      }, {\r\n        name: 'right',\r\n        text: i18n.translate('alignRight'),\r\n        icon: 'align-right',\r\n        param: 'right'\r\n      }\r\n    ];\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  AlignmentButton.prototype.setActive = function(active, align) {\r\n    if (align == null) {\r\n      align = 'left';\r\n    }\r\n    if (align !== 'left' && align !== 'center' && align !== 'right') {\r\n      align = 'left';\r\n    }\r\n    if (align === 'left') {\r\n      Button.prototype.setActive.call(this, false);\r\n    } else {\r\n      Button.prototype.setActive.call(this, active);\r\n    }\r\n    this.el.removeClass('align-left align-center align-right');\r\n    if (active) {\r\n      this.el.addClass('align-' + align);\r\n    }\r\n    this.setIcon('align-' + align);\r\n    return this.menuEl.find('.menu-item').show().end().find('.menu-item-' + align).hide();\r\n  };\r\n\r\n  AlignmentButton.prototype._status = function() {\r\n    var value = this.editor.editable.status(\"alignment\",this.htmlTag);\r\n    if (value) {\r\n      this.setDisabled(false);\r\n      return this.setActive(true, value);\r\n    } else {\r\n      this.setDisabled(true);\r\n      return this.setActive(false);\r\n    }    \r\n  };\r\n\r\n  AlignmentButton.prototype.command = function(align) {\r\n    return this.editor.editable.alignment(align,this.htmlTag);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(AlignmentButton);\r\n\r\n  return AlignmentButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/BlockquoteButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n   var BlockquoteButton = Button.inherit({\r\n\r\n   });\r\n\r\n  BlockquoteButton.prototype.name = 'blockquote';\r\n\r\n  BlockquoteButton.prototype.icon = 'quote-left';\r\n\r\n  BlockquoteButton.prototype.htmlTag = 'blockquote';\r\n\r\n  BlockquoteButton.prototype.disableTag = 'pre, table';\r\n\r\n  BlockquoteButton.prototype.command = function() {\r\n    return this.editor.editable.blockquote(this.htmlTag,this.disableTag);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(BlockquoteButton); \r\n\r\n  return BlockquoteButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/BoldButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  \r\n    var BoldButton = Button.inherit({\r\n\r\n    });\r\n\r\n    BoldButton.prototype.name = 'bold';\r\n\r\n    BoldButton.prototype.icon = 'bold';\r\n\r\n    BoldButton.prototype.htmlTag = 'b, strong';\r\n\r\n    BoldButton.prototype.disableTag = 'pre';\r\n\r\n    BoldButton.prototype.shortcut = 'cmd+b';\r\n\r\n    BoldButton.prototype._init = function() {\r\n      if (this.editor.editable.util.os.mac) {\r\n        this.title = this.title + ' ( Cmd + b )';\r\n      } else {\r\n        this.title = this.title + ' ( Ctrl + b )';\r\n        this.shortcut = 'ctrl+b';\r\n      }\r\n      return Button.prototype._init.call(this);\r\n    };\r\n\r\n    BoldButton.prototype._activeStatus = function() {\r\n      var active;\r\n      active = this.editor.editable.isActive('bold');\r\n      this.setActive(active);\r\n      return this.active;\r\n    };\r\n\r\n    BoldButton.prototype.command = function() {\r\n      return this.editor.editable.bold();\r\n    };\r\n\r\n\r\n    RichEditor.Toolbar.addButton(BoldButton);\r\n\r\n    return BoldButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/CodePopover',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Popover\"\r\n],function($,Toolbar,RichEditor,Popover){ \r\n  \r\n   var CodePopover = Popover.inherit({\r\n\r\n   });\r\n\r\n  CodePopover.prototype.render = function() {\r\n    var $option, k, lang, len, ref;\r\n    this._tpl = \"<div class=\\\"code-settings\\\">\\n  <div class=\\\"settings-field\\\">\\n    <select class=\\\"select-lang\\\">\\n      <option value=\\\"-1\\\">\" + (this._t('selectLanguage')) + \"</option>\\n    </select>\\n  </div>\\n</div>\";\r\n    this.langs = this.editor.opts.codeLanguages || [\r\n      {\r\n        name: 'Bash',\r\n        value: 'bash'\r\n      }, {\r\n        name: 'C++',\r\n        value: 'c++'\r\n      }, {\r\n        name: 'C#',\r\n        value: 'cs'\r\n      }, {\r\n        name: 'CSS',\r\n        value: 'css'\r\n      }, {\r\n        name: 'Erlang',\r\n        value: 'erlang'\r\n      }, {\r\n        name: 'Less',\r\n        value: 'less'\r\n      }, {\r\n        name: 'Sass',\r\n        value: 'sass'\r\n      }, {\r\n        name: 'Diff',\r\n        value: 'diff'\r\n      }, {\r\n        name: 'CoffeeScript',\r\n        value: 'coffeescript'\r\n      }, {\r\n        name: 'HTML,XML',\r\n        value: 'html'\r\n      }, {\r\n        name: 'JSON',\r\n        value: 'json'\r\n      }, {\r\n        name: 'Java',\r\n        value: 'java'\r\n      }, {\r\n        name: 'JavaScript',\r\n        value: 'js'\r\n      }, {\r\n        name: 'Markdown',\r\n        value: 'markdown'\r\n      }, {\r\n        name: 'Objective C',\r\n        value: 'oc'\r\n      }, {\r\n        name: 'PHP',\r\n        value: 'php'\r\n      }, {\r\n        name: 'Perl',\r\n        value: 'parl'\r\n      }, {\r\n        name: 'Python',\r\n        value: 'python'\r\n      }, {\r\n        name: 'Ruby',\r\n        value: 'ruby'\r\n      }, {\r\n        name: 'SQL',\r\n        value: 'sql'\r\n      }\r\n    ];\r\n    this.el.addClass('code-popover').append(this._tpl);\r\n    this.selectEl = this.el.find('.select-lang');\r\n    ref = this.langs;\r\n    for (k = 0, len = ref.length; k < len; k++) {\r\n      lang = ref[k];\r\n      $option = $('<option/>', {\r\n        text: lang.name,\r\n        value: lang.value\r\n      }).appendTo(this.selectEl);\r\n    }\r\n    this.selectEl.on('change', (function(_this) {\r\n      return function(e) {\r\n        var selected;\r\n        _this.lang = _this.selectEl.val();\r\n        selected = _this.target.hasClass('selected');\r\n        _this.target.removeClass().removeAttr('data-lang');\r\n        if (_this.lang !== -1) {\r\n          _this.target.attr('data-lang', _this.lang);\r\n        }\r\n        if (selected) {\r\n          _this.target.addClass('selected');\r\n        }\r\n        return _this.editor.trigger('valuechanged');\r\n      };\r\n    })(this));\r\n    return this.editor.on('valuechanged', (function(_this) {\r\n      return function(e) {\r\n        if (_this.active) {\r\n          return _this.refresh();\r\n        }\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  CodePopover.prototype.show = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Popover.prototype.show.apply(this, args);\r\n    this.lang = this.target.attr('data-lang');\r\n    if (this.lang != null) {\r\n      return this.selectEl.val(this.lang);\r\n    } else {\r\n      return this.selectEl.val(-1);\r\n    }\r\n  };\r\n\r\n  return CodePopover;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/CodeButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"./CodePopover\"\r\n],function($,Toolbar,RichEditor,Button,CodePopover){ \r\n  \r\n\r\n   var CodeButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n\r\n  CodeButton.prototype.name = 'code';\r\n\r\n  CodeButton.prototype.icon = 'code';\r\n\r\n  CodeButton.prototype.htmlTag = 'pre';\r\n\r\n  CodeButton.prototype.disableTag = 'ul, ol, table';\r\n\r\n  CodeButton.prototype._init = function() {\r\n    Button.prototype._init.call(this);\r\n    this.editor.on('decorate', (function(_this) {\r\n      return function(e, $el) {\r\n        return $el.find('pre').each(function(i, pre) {\r\n          return _this.decorate($(pre));\r\n        });\r\n      };\r\n    })(this));\r\n    return this.editor.on('undecorate', (function(_this) {\r\n      return function(e, $el) {\r\n        return $el.find('pre').each(function(i, pre) {\r\n          return _this.undecorate($(pre));\r\n        });\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  CodeButton.prototype.render = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Button.prototype.render.apply(this, args);\r\n    return this.popover = new CodePopover({\r\n      button: this\r\n    });\r\n  };\r\n\r\n  CodeButton.prototype._checkMode = function() {\r\n    var $blockNodes, range;\r\n    range = this.editor.editable.selection.range();\r\n    if (($blockNodes = $(range.cloneContents()).find(this.editor.editable.util.blockNodes.join(','))) > 0 || (range.collapsed && this.editor.editable.selection.startNodes().filter('code').length === 0)) {\r\n      this.inlineMode = false;\r\n      return this.htmlTag = 'pre';\r\n    } else {\r\n      this.inlineMode = true;\r\n      return this.htmlTag = 'code';\r\n    }\r\n  };\r\n\r\n  CodeButton.prototype._status = function() {\r\n    this._checkMode();\r\n    Button.prototype._status.call(this);\r\n    if (this.inlineMode) {\r\n      return;\r\n    }\r\n    if (this.active) {\r\n      return this.popover.show(this.node);\r\n    } else {\r\n      return this.popover.hide();\r\n    }\r\n  };\r\n\r\n  CodeButton.prototype.decorate = function($pre) {\r\n    var $code, lang, ref, ref1;\r\n    $code = $pre.find('> code');\r\n    if ($code.length > 0) {\r\n      lang = (ref = $code.attr('class')) != null ? (ref1 = ref.match(/lang-(\\S+)/)) != null ? ref1[1] : void 0 : void 0;\r\n      $code.contents().unwrap();\r\n      if (lang) {\r\n        return $pre.attr('data-lang', lang);\r\n      }\r\n    }\r\n  };\r\n\r\n  CodeButton.prototype.undecorate = function($pre) {\r\n    var $code, lang;\r\n    lang = $pre.attr('data-lang');\r\n    $code = $('<code/>');\r\n    if (lang && lang !== -1) {\r\n      $code.addClass('lang-' + lang);\r\n    }\r\n    return $pre.wrapInner($code).removeAttr('data-lang');\r\n  };\r\n\r\n  CodeButton.prototype.command = function() {\r\n    if (this.inlineMode) {\r\n      return this._inlineCommand();\r\n    } else {\r\n      return this._blockCommand();\r\n    }\r\n  };\r\n\r\n  CodeButton.prototype._blockCommand = function() {\r\n    return this.editor.editable.blockCode(this.htmlTag,this.disableTag);\r\n  };\r\n\r\n  CodeButton.prototype._inlineCommand = function() {\r\n    return this.editor.editable.inlineCode(this.active);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(CodeButton);    \r\n\r\n  return CodeButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/ColorButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,RichEditor,Button,i18n){ \r\n  \r\n\r\n   var ColorButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  ColorButton.prototype.name = 'color';\r\n\r\n  ColorButton.prototype.icon = 'tint';\r\n\r\n  ColorButton.prototype.disableTag = 'pre';\r\n\r\n  ColorButton.prototype.menu = true;\r\n\r\n  ColorButton.prototype.render = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    return Button.prototype.render.apply(this, args);\r\n  };\r\n\r\n  ColorButton.prototype.renderMenu = function() {\r\n    $('<ul class=\"color-list\">\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-1\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-2\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-3\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-4\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-5\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-6\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-7\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-default\"></a></li>\\n</ul>').appendTo(this.menuWrapper);\r\n    this.menuWrapper.on('mousedown', '.color-list', function(e) {\r\n      return false;\r\n    });\r\n    return this.menuWrapper.on('click', '.font-color', (function(_this) {\r\n      return function(e) {\r\n        var $link, $p, hex, range, rgb, textNode;\r\n        _this.wrapper.removeClass('menu-on');\r\n        $link = $(e.currentTarget);\r\n        if ($link.hasClass('font-color-default')) {\r\n          $p = _this.editor.body.find('p, li');\r\n          if (!($p.length > 0)) {\r\n            return;\r\n          }\r\n          rgb = window.getComputedStyle($p[0], null).getPropertyValue('color');\r\n          hex = _this._convertRgbToHex(rgb);\r\n        } else {\r\n          rgb = window.getComputedStyle($link[0], null).getPropertyValue('background-color');\r\n          hex = _this._convertRgbToHex(rgb);\r\n        }\r\n        if (!hex) {\r\n          return;\r\n        }\r\n\r\n        return _this.editor.editable.fontColor(hex,$link.hasClass('font-color-default'),i18n.translate('coloredText'));\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  ColorButton.prototype._convertRgbToHex = function(rgb) {\r\n    var match, re, rgbToHex;\r\n    re = /rgb\\((\\d+),\\s?(\\d+),\\s?(\\d+)\\)/g;\r\n    match = re.exec(rgb);\r\n    if (!match) {\r\n      return '';\r\n    }\r\n    rgbToHex = function(r, g, b) {\r\n      var componentToHex;\r\n      componentToHex = function(c) {\r\n        var hex;\r\n        hex = c.toString(16);\r\n        if (hex.length === 1) {\r\n          return '0' + hex;\r\n        } else {\r\n          return hex;\r\n        }\r\n      };\r\n      return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\r\n    };\r\n    return rgbToHex(match[1] * 1, match[2] * 1, match[3] * 1);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(ColorButton);\r\n\r\n  return ColorButton;\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/buttons/FontScaleButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,RichEditor,Button,i18n){ \r\n  \r\n   var FontScaleButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n\r\n  FontScaleButton.prototype.name = 'fontScale';\r\n\r\n  FontScaleButton.prototype.icon = 'font';\r\n\r\n  FontScaleButton.prototype.htmlTag = 'span';\r\n\r\n  FontScaleButton.prototype.disableTag = 'pre, h1, h2, h3, h4, h5';\r\n\r\n\r\n  FontScaleButton.prototype._init = function() {\r\n    this.menu = [\r\n      {\r\n        name: '150%',\r\n        text: i18n.translate('fontScaleXLarge'),\r\n        param: '5'\r\n      }, {\r\n        name: '125%',\r\n        text: i18n.translate('fontScaleLarge'),\r\n        param: '4'\r\n      }, {\r\n        name: '100%',\r\n        text: i18n.translate('fontScaleNormal'),\r\n        param: '3'\r\n      }, {\r\n        name: '75%',\r\n        text: i18n.translate('fontScaleSmall'),\r\n        param: '2'\r\n      }, {\r\n        name: '50%',\r\n        text: i18n.translate('fontScaleXSmall'),\r\n        param: '1'\r\n      }\r\n    ];\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  FontScaleButton.prototype._activeStatus = function() {\r\n    var active, endNode, endNodes, range, startNode, startNodes;\r\n    range = this.editor.editable.selection.range();\r\n    startNodes = this.editor.editable.selection.startNodes();\r\n    endNodes = this.editor.editable.selection.endNodes();\r\n    startNode = startNodes.filter('span[style*=\"font-size\"]');\r\n    endNode = endNodes.filter('span[style*=\"font-size\"]');\r\n    active = startNodes.length > 0 && endNodes.length > 0 && startNode.is(endNode);\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  FontScaleButton.prototype.command = function(param) {\r\n    return this.editor.editable.fontScale(param);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(FontScaleButton);\r\n\r\n  return FontScaleButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/HrButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  \r\n\r\n   var HrButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  HrButton.prototype.name = 'hr';\r\n\r\n  HrButton.prototype.icon = 'minus';\r\n\r\n  HrButton.prototype.htmlTag = 'hr';\r\n\r\n  HrButton.prototype._status = function() {};\r\n\r\n  HrButton.prototype.command = function() {\r\n    return this.editor.editable.hr();\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(HrButton);\r\n\r\n  return HrButton;\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/buttons/ImagePopover',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Popover\"\r\n],function(langx, $,Toolbar,RichEditor,Popover){ \r\n   var ImagePopover = Popover.inherit({\r\n\r\n   });\r\n\r\n  ImagePopover.prototype.offset = {\r\n    top: 6,\r\n    left: -4\r\n  };\r\n\r\n  ImagePopover.prototype.render = function() {\r\n    var tpl;\r\n    tpl = \"<div class=\\\"link-settings\\\">\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('imageUrl')) + \"</label>\\n    <input class=\\\"image-src\\\" type=\\\"text\\\" tabindex=\\\"1\\\" />\\n    <a class=\\\"btn-upload\\\" href=\\\"javascript:;\\\"\\n      title=\\\"\" + (this._t('uploadImage')) + \"\\\" tabindex=\\\"-1\\\">\\n      <span class=\\\"richeditor-icon richeditor-icon-upload\\\"></span>\\n    </a>\\n  </div>\\n  <div class='settings-field'>\\n    <label>\" + (this._t('imageAlt')) + \"</label>\\n    <input class=\\\"image-alt\\\" id=\\\"image-alt\\\" type=\\\"text\\\" tabindex=\\\"1\\\" />\\n  </div>\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('imageSize')) + \"</label>\\n    <input class=\\\"image-size\\\" id=\\\"image-width\\\" type=\\\"text\\\" tabindex=\\\"2\\\" />\\n    <span class=\\\"times\\\">×</span>\\n    <input class=\\\"image-size\\\" id=\\\"image-height\\\" type=\\\"text\\\" tabindex=\\\"3\\\" />\\n    <a class=\\\"btn-restore\\\" href=\\\"javascript:;\\\"\\n      title=\\\"\" + (this._t('restoreImageSize')) + \"\\\" tabindex=\\\"-1\\\">\\n      <span class=\\\"richeditor-icon richeditor-icon-undo\\\"></span>\\n    </a>\\n  </div>\\n</div>\";\r\n    this.el.addClass('image-popover').append(tpl);\r\n    this.srcEl = this.el.find('.image-src');\r\n    this.widthEl = this.el.find('#image-width');\r\n    this.heightEl = this.el.find('#image-height');\r\n    this.altEl = this.el.find('#image-alt');\r\n    this.srcEl.on('keydown', (function(_this) {\r\n      return function(e) {\r\n        var range;\r\n        if (!(e.which === 13 && !_this.target.hasClass('uploading'))) {\r\n          return;\r\n        }\r\n        e.preventDefault();\r\n        range = document.createRange();\r\n        _this.button.editor.editable.selection.setRangeAfter(_this.target, range);\r\n        return _this.hide();\r\n      };\r\n    })(this));\r\n    this.srcEl.on('blur', (function(_this) {\r\n      return function(e) {\r\n        return _this._loadImage(_this.srcEl.val());\r\n      };\r\n    })(this));\r\n    this.el.find('.image-size').on('blur', (function(_this) {\r\n      return function(e) {\r\n        _this._resizeImg($(e.currentTarget));\r\n        return _this.el.data('popover').refresh();\r\n      };\r\n    })(this));\r\n    this.el.find('.image-size').on('keyup', (function(_this) {\r\n      return function(e) {\r\n        var inputEl;\r\n        inputEl = $(e.currentTarget);\r\n        if (!(e.which === 13 || e.which === 27 || e.which === 9)) {\r\n          return _this._resizeImg(inputEl, true);\r\n        }\r\n      };\r\n    })(this));\r\n    this.el.find('.image-size').on('keydown', (function(_this) {\r\n      return function(e) {\r\n        var $img, inputEl, range;\r\n        inputEl = $(e.currentTarget);\r\n        if (e.which === 13 || e.which === 27) {\r\n          e.preventDefault();\r\n          if (e.which === 13) {\r\n            _this._resizeImg(inputEl);\r\n          } else {\r\n            _this._restoreImg();\r\n          }\r\n          $img = _this.target;\r\n          _this.hide();\r\n          range = document.createRange();\r\n          return _this.button.editor.editable.selection.setRangeAfter($img, range);\r\n        } else if (e.which === 9) {\r\n          return _this.el.data('popover').refresh();\r\n        }\r\n      };\r\n    })(this));\r\n    this.altEl.on('keydown', (function(_this) {\r\n      return function(e) {\r\n        var range;\r\n        if (e.which === 13) {\r\n          e.preventDefault();\r\n          range = document.createRange();\r\n          _this.button.editor.editable.selection.setRangeAfter(_this.target, range);\r\n          return _this.hide();\r\n        }\r\n      };\r\n    })(this));\r\n    this.altEl.on('keyup', (function(_this) {\r\n      return function(e) {\r\n        if (e.which === 13 || e.which === 27 || e.which === 9) {\r\n          return;\r\n        }\r\n        _this.alt = _this.altEl.val();\r\n        return _this.target.attr('alt', _this.alt);\r\n      };\r\n    })(this));\r\n    this.el.find('.btn-restore').on('click', (function(_this) {\r\n      return function(e) {\r\n        _this._restoreImg();\r\n        return _this.el.data('popover').refresh();\r\n      };\r\n    })(this));\r\n    this.editor.on('valuechanged', (function(_this) {\r\n      return function(e) {\r\n        if (_this.active) {\r\n          return _this.refresh();\r\n        }\r\n      };\r\n    })(this));\r\n    return this._initUploader();\r\n  };\r\n\r\n  ImagePopover.prototype._initUploader = function() {\r\n    var $uploadBtn, createInput;\r\n    $uploadBtn = this.el.find('.btn-upload');\r\n    if (this.editor.uploader == null) {\r\n      $uploadBtn.remove();\r\n      return;\r\n    }\r\n    createInput = (function(_this) {\r\n      return function() {\r\n        if (_this.input) {\r\n          _this.input.remove();\r\n        }\r\n        return _this.input = $('<input/>', {\r\n          type: 'file',\r\n          title: _this._t('uploadImage'),\r\n          multiple: true,\r\n          accept: 'image/gif,image/jpeg,image/jpg,image/png,image/svg'\r\n        }).appendTo($uploadBtn);\r\n      };\r\n    })(this);\r\n    createInput();\r\n    this.el.on('click mousedown', 'input[type=file]', function(e) {\r\n      return e.stopPropagation();\r\n    });\r\n    return this.el.on('change', 'input[type=file]', (function(_this) {\r\n      return function(e) {\r\n        _this.editor.uploader.upload(_this.input, {\r\n          inline: true,\r\n          img: _this.target\r\n        });\r\n        return createInput();\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  ImagePopover.prototype._resizeImg = function(inputEl, onlySetVal) {\r\n    var height, value, width;\r\n    if (onlySetVal == null) {\r\n      onlySetVal = false;\r\n    }\r\n    value = inputEl.val() * 1;\r\n    if (!(this.target && (langx.isNumber(value) || value < 0))) {\r\n      return;\r\n    }\r\n    if (inputEl.is(this.widthEl)) {\r\n      width = value;\r\n      height = this.height * value / this.width;\r\n      this.heightEl.val(height);\r\n    } else {\r\n      height = value;\r\n      width = this.width * value / this.height;\r\n      this.widthEl.val(width);\r\n    }\r\n    if (!onlySetVal) {\r\n      this.target.attr({\r\n        width: width,\r\n        height: height\r\n      });\r\n      return this.editor.trigger('valuechanged');\r\n    }\r\n  };\r\n\r\n  ImagePopover.prototype._restoreImg = function() {\r\n    var ref, size;\r\n    size = ((ref = this.target.data('image-size')) != null ? ref.split(\",\") : void 0) || [this.width, this.height];\r\n    this.target.attr({\r\n      width: size[0] * 1,\r\n      height: size[1] * 1\r\n    });\r\n    this.widthEl.val(size[0]);\r\n    this.heightEl.val(size[1]);\r\n    return this.editor.trigger('valuechanged');\r\n  };\r\n\r\n  ImagePopover.prototype._loadImage = function(src, callback) {\r\n    if (/^data:image/.test(src) && !this.editor.uploader) {\r\n      if (callback) {\r\n        callback(false);\r\n      }\r\n      return;\r\n    }\r\n    if (this.target.attr('src') === src) {\r\n      return;\r\n    }\r\n    return this.button.loadImage(this.target, src, (function(_this) {\r\n      return function(img) {\r\n        var blob;\r\n        if (!img) {\r\n          return;\r\n        }\r\n        if (_this.active) {\r\n          _this.width = img.width;\r\n          _this.height = img.height;\r\n          _this.widthEl.val(_this.width);\r\n          _this.heightEl.val(_this.height);\r\n        }\r\n        if (/^data:image/.test(src)) {\r\n          blob = _this.editor.editable.util.dataURLtoBlob(src);\r\n          blob.name = \"Base64 Image.png\";\r\n          _this.editor.uploader.upload(blob, {\r\n            inline: true,\r\n            img: _this.target\r\n          });\r\n        } else {\r\n          _this.editor.trigger('valuechanged');\r\n        }\r\n        if (callback) {\r\n          return callback(img);\r\n        }\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  ImagePopover.prototype.show = function() {\r\n    var $img, args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Popover.prototype.show.apply(this, args);\r\n    $img = this.target;\r\n    this.width = $img.width();\r\n    this.height = $img.height();\r\n    this.alt = $img.attr('alt');\r\n    if ($img.hasClass('uploading')) {\r\n      return this.srcEl.val(this._t('uploading')).prop('disabled', true);\r\n    } else {\r\n      this.srcEl.val($img.attr('src')).prop('disabled', false);\r\n      this.widthEl.val(this.width);\r\n      this.heightEl.val(this.height);\r\n      return this.altEl.val(this.alt);\r\n    }\r\n  };\r\n\r\n  return ImagePopover;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/ImageButton',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"./ImagePopover\"\r\n],function(langx, $,Toolbar,RichEditor,Button,ImagePopover){ \r\n   var ImageButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  ImageButton.prototype.name = 'image';\r\n\r\n  ImageButton.prototype.icon = 'picture-o';\r\n\r\n  ImageButton.prototype.htmlTag = 'img';\r\n\r\n  ImageButton.prototype.disableTag = 'pre, table';\r\n\r\n  ImageButton.prototype.defaultImage = '';\r\n\r\n  ImageButton.prototype.needFocus = false;\r\n\r\n  ImageButton.prototype._init = function() {\r\n    var item, k, len, ref;\r\n    if (this.editor.opts.imageButton) {\r\n      if (Array.isArray(this.editor.opts.imageButton)) {\r\n        this.menu = [];\r\n        ref = this.editor.opts.imageButton;\r\n        for (k = 0, len = ref.length; k < len; k++) {\r\n          item = ref[k];\r\n          this.menu.push({\r\n            name: item + '-image',\r\n            text: this._t(item + 'Image')\r\n          });\r\n        }\r\n      } else {\r\n        this.menu = false;\r\n      }\r\n    } else {\r\n      if (this.editor.uploader != null) {\r\n        this.menu = [\r\n          {\r\n            name: 'upload-image',\r\n            text: this._t('uploadImage')\r\n          }, {\r\n            name: 'external-image',\r\n            text: this._t('externalImage')\r\n          }\r\n        ];\r\n      } else {\r\n        this.menu = false;\r\n      }\r\n    }\r\n    this.defaultImage = this.editor.opts.defaultImage;\r\n    this.editor.body.on('click', 'img:not([data-non-image])', (function(_this) {\r\n      return function(e) {\r\n        var $img, range;\r\n        $img = $(e.currentTarget);\r\n        range = document.createRange();\r\n        range.selectNode($img[0]);\r\n        _this.editor.editable.selection.range(range);\r\n        if (!_this.editor.editable.util.support.onselectionchange) {\r\n          _this.editor.trigger('selectionchanged');\r\n        }\r\n        return false;\r\n      };\r\n    })(this));\r\n    this.editor.body.on('mouseup', 'img:not([data-non-image])', function(e) {\r\n      return false;\r\n    });\r\n    this.editor.on('selectionchanged.image', (function(_this) {\r\n      return function() {\r\n        var $contents, $img, range;\r\n        range = _this.editor.editable.selection.range();\r\n        if (range == null) {\r\n          return;\r\n        }\r\n        $contents = $(range.cloneContents()).contents();\r\n        if ($contents.length === 1 && $contents.is('img:not([data-non-image])')) {\r\n          $img = $(range.startContainer).contents().eq(range.startOffset);\r\n          return _this.popover.show($img);\r\n        } else {\r\n          return _this.popover.hide();\r\n        }\r\n      };\r\n    })(this));\r\n    this.editor.on('valuechanged.image', (function(_this) {\r\n      return function() {\r\n        var $masks;\r\n        $masks = _this.editor.wrapper.find('.richeditor-image-loading');\r\n        if (!($masks.length > 0)) {\r\n          return;\r\n        }\r\n        return $masks.each(function(i, mask) {\r\n          var $img, $mask, file;\r\n          $mask = $(mask);\r\n          $img = $mask.data('img');\r\n          if (!($img && $img.parent().length > 0)) {\r\n            $mask.remove();\r\n            if ($img) {\r\n              file = $img.data('file');\r\n              if (file) {\r\n                _this.editor.uploader.cancel(file);\r\n                if (_this.editor.body.find('img.uploading').length < 1) {\r\n                  return _this.editor.uploader.trigger('uploadready', [file]);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        });\r\n      };\r\n    })(this));\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  ImageButton.prototype.render = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Button.prototype.render.apply(this, args);\r\n    this.popover = new ImagePopover({\r\n      button: this\r\n    });\r\n    if (this.editor.opts.imageButton === 'upload') {\r\n      return this._initUploader(this.el);\r\n    }\r\n  };\r\n\r\n  ImageButton.prototype.renderMenu = function() {\r\n    Button.prototype.renderMenu.call(this);\r\n    return this._initUploader();\r\n  };\r\n\r\n  ImageButton.prototype._initUploader = function($uploadItem) {\r\n    var $input, createInput, uploadProgress;\r\n    if ($uploadItem == null) {\r\n      $uploadItem = this.menuEl.find('.menu-item-upload-image');\r\n    }\r\n    if (this.editor.uploader == null) {\r\n      this.el.find('.btn-upload').remove();\r\n      return;\r\n    }\r\n    $input = null;\r\n    createInput = (function(_this) {\r\n      return function() {\r\n        if ($input) {\r\n          $input.remove();\r\n        }\r\n        return $input = $('<input/>', {\r\n          type: 'file',\r\n          title: _this._t('uploadImage'),\r\n          multiple: true,\r\n          accept: 'image/gif,image/jpeg,image/jpg,image/png,image/svg'\r\n        }).appendTo($uploadItem);\r\n      };\r\n    })(this);\r\n    createInput();\r\n    $uploadItem.on('click mousedown', 'input[type=file]', function(e) {\r\n      return e.stopPropagation();\r\n    });\r\n    $uploadItem.on('change', 'input[type=file]', (function(_this) {\r\n      return function(e) {\r\n        if (_this.editor.editable.inputManager.focused) {\r\n          _this.editor.uploader.upload($input, {\r\n            inline: true\r\n          });\r\n          createInput();\r\n        } else {\r\n          _this.editor.one('focus', function(e) {\r\n            _this.editor.uploader.upload($input, {\r\n              inline: true\r\n            });\r\n            return createInput();\r\n          });\r\n          _this.editor.focus();\r\n        }\r\n        return _this.wrapper.removeClass('menu-on');\r\n      };\r\n    })(this));\r\n    this.editor.uploader.on('beforeupload', (function(_this) {\r\n      return function(e, file) {\r\n        var $img;\r\n        if (!file.inline) {\r\n          return;\r\n        }\r\n        if (file.img) {\r\n          $img = $(file.img);\r\n        } else {\r\n          $img = _this.createImage(file.name);\r\n          file.img = $img;\r\n        }\r\n        $img.addClass('uploading');\r\n        $img.data('file', file);\r\n        return _this.editor.uploader.readImageFile(file.obj, function(img) {\r\n          var src;\r\n          if (!$img.hasClass('uploading')) {\r\n            return;\r\n          }\r\n          src = img ? img.src : _this.defaultImage;\r\n          return _this.loadImage($img, src, function() {\r\n            if (_this.popover.active) {\r\n              _this.popover.refresh();\r\n              return _this.popover.srcEl.val(_this._t('uploading')).prop('disabled', true);\r\n            }\r\n          });\r\n        });\r\n      };\r\n    })(this));\r\n    uploadProgress = langx.proxy(this.editor.editable.util.throttle(function(e, file, loaded, total) {\r\n      var $img, $mask, percent;\r\n      if (!file.inline) {\r\n        return;\r\n      }\r\n      $mask = file.img.data('mask');\r\n      if (!$mask) {\r\n        return;\r\n      }\r\n      $img = $mask.data('img');\r\n      if (!($img.hasClass('uploading') && $img.parent().length > 0)) {\r\n        $mask.remove();\r\n        return;\r\n      }\r\n      percent = loaded / total;\r\n      percent = (percent * 100).toFixed(0);\r\n      if (percent > 99) {\r\n        percent = 99;\r\n      }\r\n      return $mask.find('.progress').height((100 - percent) + \"%\");\r\n    }, 500), this);\r\n    this.editor.uploader.on('uploadprogress', uploadProgress);\r\n    this.editor.uploader.on('uploadsuccess', (function(_this) {\r\n      return function(e, file, result) {\r\n        var $img, img_path, msg;\r\n        if (!file.inline) {\r\n          return;\r\n        }\r\n        $img = file.img;\r\n        if (!($img.hasClass('uploading') && $img.parent().length > 0)) {\r\n          return;\r\n        }\r\n        if (typeof result !== 'object') {\r\n          try {\r\n            result = JSON.parse(result);\r\n          } catch (_error) {\r\n            e = _error;\r\n            result = {\r\n              success: false\r\n            };\r\n          }\r\n        }\r\n        if (result.success === false) {\r\n          msg = result.msg || _this._t('uploadFailed');\r\n          alert(msg);\r\n          img_path = _this.defaultImage;\r\n        } else {\r\n          img_path = result.file_path;\r\n        }\r\n        _this.loadImage($img, img_path, function() {\r\n          var $mask;\r\n          $img.removeData('file');\r\n          $img.removeClass('uploading').removeClass('loading');\r\n          $mask = $img.data('mask');\r\n          if ($mask) {\r\n            $mask.remove();\r\n          }\r\n          $img.removeData('mask');\r\n          _this.editor.trigger('valuechanged');\r\n          if (_this.editor.body.find('img.uploading').length < 1) {\r\n            return _this.editor.uploader.trigger('uploadready', [file, result]);\r\n          }\r\n        });\r\n        if (_this.popover.active) {\r\n          _this.popover.srcEl.prop('disabled', false);\r\n          return _this.popover.srcEl.val(result.file_path);\r\n        }\r\n      };\r\n    })(this));\r\n    return this.editor.uploader.on('uploaderror', (function(_this) {\r\n      return function(e, file, xhr) {\r\n        var $img, msg, result;\r\n        if (!file.inline) {\r\n          return;\r\n        }\r\n        if (xhr.statusText === 'abort') {\r\n          return;\r\n        }\r\n        if (xhr.responseText) {\r\n          try {\r\n            result = JSON.parse(xhr.responseText);\r\n            msg = result.msg;\r\n          } catch (_error) {\r\n            e = _error;\r\n            msg = _this._t('uploadError');\r\n          }\r\n        }\r\n        $img = file.img;\r\n        if (!($img.hasClass('uploading') && $img.parent().length > 0)) {\r\n          return;\r\n        }\r\n        _this.loadImage($img, _this.defaultImage, function() {\r\n          var $mask;\r\n          $img.removeData('file');\r\n          $img.removeClass('uploading').removeClass('loading');\r\n          $mask = $img.data('mask');\r\n          if ($mask) {\r\n            $mask.remove();\r\n          }\r\n          return $img.removeData('mask');\r\n        });\r\n        if (_this.popover.active) {\r\n          _this.popover.srcEl.prop('disabled', false);\r\n          _this.popover.srcEl.val(_this.defaultImage);\r\n        }\r\n        _this.editor.trigger('valuechanged');\r\n        if (_this.editor.body.find('img.uploading').length < 1) {\r\n          return _this.editor.uploader.trigger('uploadready', [file, result]);\r\n        }\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  ImageButton.prototype._status = function() {\r\n    return this._disableStatus();\r\n  };\r\n\r\n  ImageButton.prototype.loadImage = function($img, src, callback) {\r\n    var $mask, img, positionMask;\r\n    positionMask = (function(_this) {\r\n      return function() {\r\n        var imgOffset, wrapperOffset;\r\n        imgOffset = $img.offset();\r\n        wrapperOffset = _this.editor.wrapper.offset();\r\n        return $mask.css({\r\n          top: imgOffset.top - wrapperOffset.top,\r\n          left: imgOffset.left - wrapperOffset.left,\r\n          width: $img.width(),\r\n          height: $img.height()\r\n        }).show();\r\n      };\r\n    })(this);\r\n    $img.addClass('loading');\r\n    $mask = $img.data('mask');\r\n    if (!$mask) {\r\n      $mask = $('<div class=\"richeditor-image-loading\">\\n  <div class=\"progress\"></div>\\n</div>').hide().appendTo(this.editor.wrapper);\r\n      positionMask();\r\n      $img.data('mask', $mask);\r\n      $mask.data('img', $img);\r\n    }\r\n    img = new Image();\r\n    img.onload = (function(_this) {\r\n      return function() {\r\n        var height, width;\r\n        if (!$img.hasClass('loading') && !$img.hasClass('uploading')) {\r\n          return;\r\n        }\r\n        width = img.width;\r\n        height = img.height;\r\n        $img.attr({\r\n          src: src,\r\n          width: width,\r\n          height: height,\r\n          'data-image-size': width + ',' + height\r\n        }).removeClass('loading');\r\n        if ($img.hasClass('uploading')) {\r\n          _this.editor.editable.util.reflow(_this.editor.body);\r\n          positionMask();\r\n        } else {\r\n          $mask.remove();\r\n          $img.removeData('mask');\r\n        }\r\n        if (langx.isFunction(callback)) {\r\n          return callback(img);\r\n        }\r\n      };\r\n    })(this);\r\n    img.onerror = function() {\r\n      if (langx.isFunction(callback)) {\r\n        callback(false);\r\n      }\r\n      $mask.remove();\r\n      return $img.removeData('mask').removeClass('loading');\r\n    };\r\n    return img.src = src;\r\n  };\r\n\r\n  ImageButton.prototype.createImage = function(name) {\r\n    var $img, range;\r\n    if (name == null) {\r\n      name = 'Image';\r\n    }\r\n    if (!this.editor.editable.inputManager.focused) {\r\n      this.editor.focus();\r\n    }\r\n    range = this.editor.editable.selection.range();\r\n    range.deleteContents();\r\n    this.editor.editable.selection.range(range);\r\n    $img = $('<img/>').attr('alt', name);\r\n    range.insertNode($img[0]);\r\n    this.editor.editable.selection.setRangeAfter($img, range);\r\n    this.editor.trigger('valuechanged');\r\n    return $img;\r\n  };\r\n\r\n  ImageButton.prototype.command = function(src) {\r\n    var $img;\r\n    $img = this.createImage();\r\n    return this.loadImage($img, src || this.defaultImage, (function(_this) {\r\n      return function() {\r\n        _this.editor.trigger('valuechanged');\r\n        _this.editor.editable.util.reflow($img);\r\n        $img.click();\r\n        return _this.popover.one('popovershow', function() {\r\n          _this.popover.srcEl.focus();\r\n          return _this.popover.srcEl[0].select();\r\n        });\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(ImageButton);\t\r\n\r\n  return ImageButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/IndentButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  \r\n   var IndentButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  IndentButton.prototype.name = 'indent';\r\n\r\n  IndentButton.prototype.icon = 'indent';\r\n\r\n  IndentButton.prototype._init = function() {\r\n    var hotkey;\r\n    hotkey = this.editor.opts.tabIndent === false ? '' : ' (Tab)';\r\n    this.title = this._t(this.name) + hotkey;\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  IndentButton.prototype._status = function() {};\r\n\r\n  IndentButton.prototype.command = function() {\r\n    return this.editor.editable.indent();\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(IndentButton);\t\r\n\r\n  return IndentButton;\r\n});\ndefine('skylark-widgets-richeditor/buttons/ItalicButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  \r\n\r\n  var ItalicButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  ItalicButton.prototype.name = 'italic';\r\n\r\n  ItalicButton.prototype.icon = 'italic';\r\n\r\n  ItalicButton.prototype.htmlTag = 'i';\r\n\r\n  ItalicButton.prototype.disableTag = 'pre';\r\n\r\n  ItalicButton.prototype.shortcut = 'cmd+i';\r\n\r\n  ItalicButton.prototype._init = function() {\r\n    if (this.editor.editable.util.os.mac) {\r\n      this.title = this.title + \" ( Cmd + i )\";\r\n    } else {\r\n      this.title = this.title + \" ( Ctrl + i )\";\r\n      this.shortcut = 'ctrl+i';\r\n    }\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  ItalicButton.prototype._activeStatus = function() {\r\n    var active;\r\n    active = this.editor.editable.isActive('italic');\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  ItalicButton.prototype.command = function() {\r\n    return this.editor.editable.italic();\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(ItalicButton); \r\n\r\n  return ItalicButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/LinkPopover',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Popover\"\r\n],function($,Toolbar,RichEditor,Popover){ \r\n  var LinkPopover = Popover.inherit({\r\n\r\n  });\r\n\r\n  LinkPopover.prototype.render = function() {\r\n    var tpl;\r\n    tpl = \"<div class=\\\"link-settings\\\">\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('linkText')) + \"</label>\\n    <input class=\\\"link-text\\\" type=\\\"text\\\"/>\\n    <a class=\\\"btn-unlink\\\" href=\\\"javascript:;\\\" title=\\\"\" + (this._t('removeLink')) + \"\\\"\\n      tabindex=\\\"-1\\\">\\n      <span class=\\\"richeditor-icon richeditor-icon-unlink\\\"></span>\\n    </a>\\n  </div>\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('linkUrl')) + \"</label>\\n    <input class=\\\"link-url\\\" type=\\\"text\\\"/>\\n  </div>\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('linkTarget')) + \"</label>\\n    <select class=\\\"link-target\\\">\\n      <option value=\\\"_blank\\\">\" + (this._t('openLinkInNewWindow')) + \" (_blank)</option>\\n      <option value=\\\"_self\\\">\" + (this._t('openLinkInCurrentWindow')) + \" (_self)</option>\\n    </select>\\n  </div>\\n</div>\";\r\n    this.el.addClass('link-popover').append(tpl);\r\n    this.textEl = this.el.find('.link-text');\r\n    this.urlEl = this.el.find('.link-url');\r\n    this.unlinkEl = this.el.find('.btn-unlink');\r\n    this.selectTarget = this.el.find('.link-target');\r\n    this.textEl.on('keyup', (function(_this) {\r\n      return function(e) {\r\n        if (e.which === 13) {\r\n          return;\r\n        }\r\n        _this.target.text(_this.textEl.val());\r\n        return _this.editor.editable.inputManager.throttledValueChanged();\r\n      };\r\n    })(this));\r\n    this.urlEl.on('keyup', (function(_this) {\r\n      return function(e) {\r\n        var val;\r\n        if (e.which === 13) {\r\n          return;\r\n        }\r\n        val = _this.urlEl.val();\r\n        if (!(/^(http|https|ftp|ftps|file)?:\\/\\/|^(mailto|tel)?:|^\\//ig.test(val) || !val)) {\r\n          val = 'http://' + val;\r\n        }\r\n        _this.target.attr('href', val);\r\n        return _this.editor.editable.inputManager.throttledValueChanged();\r\n      };\r\n    })(this));\r\n    $([this.urlEl[0], this.textEl[0]]).on('keydown', (function(_this) {\r\n      return function(e) {\r\n        var range;\r\n        if (e.which === 13 || e.which === 27 || (!e.shiftKey && e.which === 9 && $(e.target).hasClass('link-url'))) {\r\n          e.preventDefault();\r\n          range = document.createRange();\r\n          _this.editor.editable.selection.setRangeAfter(_this.target, range);\r\n          _this.hide();\r\n          return _this.editor.editable.inputManager.throttledValueChanged();\r\n        }\r\n      };\r\n    })(this));\r\n    this.unlinkEl.on('click', (function(_this) {\r\n      return function(e) {\r\n        var range, txtNode;\r\n        txtNode = document.createTextNode(_this.target.text());\r\n        _this.target.replaceWith(txtNode);\r\n        _this.hide();\r\n        range = document.createRange();\r\n        _this.editor.editable.selection.setRangeAfter(txtNode, range);\r\n        return _this.editor.editable.inputManager.throttledValueChanged();\r\n      };\r\n    })(this));\r\n    return this.selectTarget.on('change', (function(_this) {\r\n      return function(e) {\r\n        _this.target.attr('target', _this.selectTarget.val());\r\n        return _this.editor.editable.inputManager.throttledValueChanged();\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  LinkPopover.prototype.show = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Popover.prototype.show.apply(this, args);\r\n    this.textEl.val(this.target.text());\r\n    return this.urlEl.val(this.target.attr('href'));\r\n  };\r\n\r\n  return LinkPopover;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/LinkButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\",\r\n  \"./LinkPopover\"\r\n],function($,Toolbar,RichEditor,Button,i18n,LinkPopover){ \r\n  \r\n\r\n  var LinkButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  LinkButton.prototype.name = 'link';\r\n\r\n  LinkButton.prototype.icon = 'link';\r\n\r\n  LinkButton.prototype.htmlTag = 'a';\r\n\r\n  LinkButton.prototype.disableTag = 'pre';\r\n\r\n  LinkButton.prototype.render = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Button.prototype.render.apply(this, args);\r\n    return this.popover = new LinkPopover({\r\n      button: this\r\n    });\r\n  };\r\n\r\n  LinkButton.prototype._status = function() {\r\n   Button.prototype._status.call(this);\r\n    if (this.active && !this.editor.editable.selection.rangeAtEndOf(this.node)) {\r\n      return this.popover.show(this.node);\r\n    } else {\r\n      return this.popover.hide();\r\n    }\r\n  };\r\n\r\n  LinkButton.prototype.command = function() {\r\n    if (this.active) {\r\n      this.popover.one('popovershow', (function(_this) {\r\n        return function() {\r\n          if (linkText) {\r\n            _this.popover.urlEl.focus();\r\n            return _this.popover.urlEl[0].select();\r\n          } else {\r\n            _this.popover.textEl.focus();\r\n            return _this.popover.textEl[0].select();\r\n          }\r\n        };\r\n      })(this));\r\n\r\n    }\r\n\r\n    return this.editor.editable.link(this.active,i18n.translate('linkText'));\r\n\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(LinkButton);\r\n\r\n  return LinkButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/ListButton',[\r\n  \"skylark-utils-dom/noder\",\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function(noder,$,Toolbar,RichEditor,Button){ \r\n  var ListButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n    ListButton.prototype.type = '';\r\n\r\n    ListButton.prototype.disableTag = 'pre, table';\r\n\r\n    ListButton.prototype.command = function(param) {\r\n      return this.editor.editable.list(this.type,param,this.disableTag);\r\n    };\r\n\r\n    return ListButton;\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/buttons/OrderListButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"./ListButton\"\r\n],function($,Toolbar,RichEditor,ListButton){ \r\n  var OrderListButton = ListButton.inherit({\r\n\r\n   });\r\n\r\n\r\n    OrderListButton.prototype.type = 'ol';\r\n\r\n    OrderListButton.prototype.name = 'ol';\r\n\r\n    OrderListButton.prototype.icon = 'list-ol';\r\n\r\n    OrderListButton.prototype.htmlTag = 'ol';\r\n\r\n    OrderListButton.prototype.shortcut = 'cmd+/';\r\n\r\n    OrderListButton.prototype._init = function() {\r\n      if (this.editor.editable.util.os.mac) {\r\n        this.title = this.title + ' ( Cmd + / )';\r\n      } else {\r\n        this.title = this.title + ' ( ctrl + / )';\r\n        this.shortcut = 'ctrl+/';\r\n      }\r\n      return ListButton.prototype._init.call(this);\r\n    };\r\n\r\n    RichEditor.Toolbar.addButton(OrderListButton);\r\n\r\n    return OrderListButton;\r\n\t\r\n});\ndefine('skylark-widgets-richeditor/buttons/OutdentButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  var OutdentButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  OutdentButton.prototype.name = 'outdent';\r\n\r\n  OutdentButton.prototype.icon = 'outdent';\r\n\r\n  OutdentButton.prototype._init = function() {\r\n    var hotkey;\r\n    hotkey = this.editor.opts.tabIndent === false ? '' : ' (Shift + Tab)';\r\n    this.title = this._t(this.name) + hotkey;\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  OutdentButton.prototype._status = function() {};\r\n\r\n  OutdentButton.prototype.command = function() {\r\n    return this.editor.editable.outdent();\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(OutdentButton);\t\r\n\r\n  return OutdentButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/StrikethroughButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){ \r\n  \r\n  var StrikethroughButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  StrikethroughButton.prototype.name = 'strikethrough';\r\n\r\n  StrikethroughButton.prototype.icon = 'strikethrough';\r\n\r\n  StrikethroughButton.prototype.htmlTag = 'strike';\r\n\r\n  StrikethroughButton.prototype.disableTag = 'pre';\r\n\r\n  StrikethroughButton.prototype._activeStatus = function() {\r\n    var active;\r\n    active = this.editor.editable.isActive('strikethrough');\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  StrikethroughButton.prototype.command = function() {\r\n    return this.editor.editable.strikethrough();\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(StrikethroughButton);\t\r\n\r\n  return StrikethroughButton;\r\n\r\n});\ndefine('skylark-utils-dom/tables',[\r\n    \"./dom\",\r\n    \"skylark-domx-tables\"\r\n], function(dom, tables) {\r\n\r\n  return dom.tables = tables;\r\n});\ndefine('skylark-widgets-richeditor/buttons/TableButton',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-utils-dom/tables\",\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function(langx,tables,$,Toolbar,RichEditor,Button){ \r\n  var TableButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  TableButton.prototype.name = 'table';\r\n\r\n  TableButton.prototype.icon = 'table';\r\n\r\n  TableButton.prototype.htmlTag = 'table';\r\n\r\n  TableButton.prototype.disableTag = 'pre, li, blockquote';\r\n\r\n  TableButton.prototype.menu = true;\r\n\r\n  TableButton.prototype._init = function() {\r\n    Button.prototype._init.call(this);\r\n    langx.merge(this.editor.editable.formatter._allowedTags, ['thead', 'th', 'tbody', 'tr', 'td', 'colgroup', 'col']);\r\n    langx.extend(this.editor.editable.formatter._allowedAttributes, {\r\n      td: ['rowspan', 'colspan'],\r\n      col: ['width']\r\n    });\r\n    langx.extend(this.editor.editable.formatter._allowedStyles, {\r\n      td: ['text-align'],\r\n      th: ['text-align']\r\n    });\r\n    this._initShortcuts();\r\n    this._initResize();\r\n    this.editor.on('decorate', (function(_this) {\r\n      return function(e, $el) {\r\n        return $el.find('table').each(function(i, table) {\r\n          return _this.decorate($(table));\r\n        });\r\n      };\r\n    })(this));\r\n    this.editor.on('undecorate', (function(_this) {\r\n      return function(e, $el) {\r\n        return $el.find('table').each(function(i, table) {\r\n          return _this.undecorate($(table));\r\n        });\r\n      };\r\n    })(this));\r\n    this.editor.on('selectionchanged.table', (function(_this) {\r\n      return function(e) {\r\n        var $container, range;\r\n        _this.editor.body.find('.richeditor-table td, .richeditor-table th').removeClass('active');\r\n        range = _this.editor.editable.selection.range();\r\n        if (!range) {\r\n          return;\r\n        }\r\n        $container = _this.editor.editable.selection.containerNode();\r\n        if (range.collapsed && $container.is('.richeditor-table')) {\r\n          _this.editor.editable.selection.setRangeAtEndOf($container);\r\n        }\r\n        return $container.closest('td, th', _this.editor.body).addClass('active');\r\n      };\r\n    })(this));\r\n    this.editor.on('blur.table', (function(_this) {\r\n      return function(e) {\r\n        return _this.editor.body.find('.richeditor-table td, .richeditor-table th').removeClass('active');\r\n      };\r\n    })(this));\r\n    this.editor.editable.keystroke.add('up', 'td', (function(_this) {\r\n      return function(e, $node) {\r\n        _this._tdNav($node, 'up');\r\n        return true;\r\n      };\r\n    })(this));\r\n    this.editor.editable.keystroke.add('up', 'th', (function(_this) {\r\n      return function(e, $node) {\r\n        _this._tdNav($node, 'up');\r\n        return true;\r\n      };\r\n    })(this));\r\n    this.editor.editable.keystroke.add('down', 'td', (function(_this) {\r\n      return function(e, $node) {\r\n        _this._tdNav($node, 'down');\r\n        return true;\r\n      };\r\n    })(this));\r\n    return this.editor.editable.keystroke.add('down', 'th', (function(_this) {\r\n      return function(e, $node) {\r\n        _this._tdNav($node, 'down');\r\n        return true;\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  TableButton.prototype._tdNav = function($td, direction) {\r\n    var $anotherTr, $tr, action, anotherTag, index, parentTag, ref;\r\n    if (direction == null) {\r\n      direction = 'up';\r\n    }\r\n    action = direction === 'up' ? 'prev' : 'next';\r\n    ref = direction === 'up' ? ['tbody', 'thead'] : ['thead', 'tbody'], parentTag = ref[0], anotherTag = ref[1];\r\n    $tr = $td.parent('tr');\r\n    $anotherTr = this[\"_\" + action + \"Row\"]($tr);\r\n    if (!($anotherTr.length > 0)) {\r\n      return true;\r\n    }\r\n    index = $tr.find('td, th').index($td);\r\n    return this.editor.editable.selection.setRangeAtEndOf($anotherTr.find('td, th').eq(index));\r\n  };\r\n\r\n  TableButton.prototype._initResize = function() {\r\n\r\n    tables.resizable(document,{\r\n      cssClasses : {\r\n        resizeHandle : \"richeditor-resize-handle\",\r\n        wrapper : \"richeditor-table\"\r\n      }\r\n    });\r\n\r\n  };\r\n\r\n  TableButton.prototype._initShortcuts = function() {\r\n    this.editor.editable.hotkeys.add('ctrl+alt+up', (function(_this) {\r\n      return function(e) {\r\n        _this.editMenu.find('.menu-item[data-param=insertRowAbove]').click();\r\n        return false;\r\n      };\r\n    })(this));\r\n    this.editor.editable.hotkeys.add('ctrl+alt+down', (function(_this) {\r\n      return function(e) {\r\n        _this.editMenu.find('.menu-item[data-param=insertRowBelow]').click();\r\n        return false;\r\n      };\r\n    })(this));\r\n    this.editor.editable.hotkeys.add('ctrl+alt+left', (function(_this) {\r\n      return function(e) {\r\n        _this.editMenu.find('.menu-item[data-param=insertColLeft]').click();\r\n        return false;\r\n      };\r\n    })(this));\r\n    return this.editor.editable.hotkeys.add('ctrl+alt+right', (function(_this) {\r\n      return function(e) {\r\n        _this.editMenu.find('.menu-item[data-param=insertColRight]').click();\r\n        return false;\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  TableButton.prototype.renderMenu = function() {\r\n    var $table;\r\n    $(\"<div class=\\\"menu-create-table\\\">\\n</div>\\n<div class=\\\"menu-edit-table\\\">\\n  <ul>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"deleteRow\\\">\\n        <span>\" + (this._t('deleteRow')) + \"</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertRowAbove\\\">\\n        <span>\" + (this._t('insertRowAbove')) + \" ( Ctrl + Alt + ↑ )</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertRowBelow\\\">\\n        <span>\" + (this._t('insertRowBelow')) + \" ( Ctrl + Alt + ↓ )</span>\\n      </a>\\n    </li>\\n    <li><span class=\\\"separator\\\"></span></li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"deleteCol\\\">\\n        <span>\" + (this._t('deleteColumn')) + \"</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertColLeft\\\">\\n        <span>\" + (this._t('insertColumnLeft')) + \" ( Ctrl + Alt + ← )</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertColRight\\\">\\n        <span>\" + (this._t('insertColumnRight')) + \" ( Ctrl + Alt + → )</span>\\n      </a>\\n    </li>\\n    <li><span class=\\\"separator\\\"></span></li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"deleteTable\\\">\\n        <span>\" + (this._t('deleteTable')) + \"</span>\\n      </a>\\n    </li>\\n  </ul>\\n</div>\").appendTo(this.menuWrapper);\r\n    this.createMenu = this.menuWrapper.find('.menu-create-table');\r\n    this.editMenu = this.menuWrapper.find('.menu-edit-table');\r\n    $table = this.createTable(6, 6).appendTo(this.createMenu);\r\n    this.createMenu.on('mouseenter', 'td, th', (function(_this) {\r\n      return function(e) {\r\n        var $td, $tr, $trs, num;\r\n        _this.createMenu.find('td, th').removeClass('selected');\r\n        $td = $(e.currentTarget);\r\n        $tr = $td.parent();\r\n        num = $tr.find('td, th').index($td) + 1;\r\n        $trs = $tr.prevAll('tr').addBack();\r\n        if ($tr.parent().is('tbody')) {\r\n          $trs = $trs.add($table.find('thead tr'));\r\n        }\r\n        return $trs.find(\"td:lt(\" + num + \"), th:lt(\" + num + \")\").addClass('selected');\r\n      };\r\n    })(this));\r\n    this.createMenu.on('mouseleave', function(e) {\r\n      return $(e.currentTarget).find('td, th').removeClass('selected');\r\n    });\r\n    return this.createMenu.on('mousedown', 'td, th', (function(_this) {\r\n      return function(e) {\r\n        var $closestBlock, $td, $tr, colNum, rowNum;\r\n        _this.wrapper.removeClass('menu-on');\r\n        if (!_this.editor.editable.inputManager.focused) {\r\n          return;\r\n        }\r\n        $td = $(e.currentTarget);\r\n        $tr = $td.parent();\r\n        colNum = $tr.find('td').index($td) + 1;\r\n        rowNum = $tr.prevAll('tr').length + 1;\r\n        if ($tr.parent().is('tbody')) {\r\n          rowNum += 1;\r\n        }\r\n        $table = _this.createTable(rowNum, colNum, true);\r\n        $closestBlock = _this.editor.editable.selection.blockNodes().last();\r\n        if (_this.editor.editable.util.isEmptyNode($closestBlock)) {\r\n          $closestBlock.replaceWith($table);\r\n        } else {\r\n          $closestBlock.after($table);\r\n        }\r\n        _this.decorate($table);\r\n        _this.editor.editable.selection.setRangeAtStartOf($table.find('th:first'));\r\n        _this.editor.trigger('valuechanged');\r\n        return false;\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  TableButton.prototype.decorate = function($table) {\r\n    return $(tables.decorate($table[0],{\r\n      tableDecorate : 'richeditor-table',\r\n      resizeHandle : 'richeditor-resize-handle'\r\n    }));\r\n\r\n  };\r\n\r\n  TableButton.prototype.undecorate = function($table) {\r\n    return $(tables.undecorate($table[0],{\r\n      tableDecorate : 'richeditor-table',\r\n      resizeHandle : 'richeditor-resize-handle'\r\n    }));\r\n\r\n  };\r\n\r\n\r\n  TableButton.prototype.createTable = function(row, col, phBr) {\r\n    return $(tables.createTable(row,col,phBr ? this.editor.editable.util.phBr : null));\r\n  };\r\n\r\n  TableButton.prototype.refreshTableWidth = function($table) {\r\n    return table.refreshTableWidth($table[0]);\r\n  };\r\n\r\n  TableButton.prototype.setActive = function(active) {\r\n    Button.prototype.setActive.call(this, active);\r\n    if (active) {\r\n      this.createMenu.hide();\r\n      return this.editMenu.show();\r\n    } else {\r\n      this.createMenu.show();\r\n      return this.editMenu.hide();\r\n    }\r\n  };\r\n\r\n  TableButton.prototype.deleteRow = function($td) {\r\n    var self = this,\r\n        ret; \r\n\r\n    tables.deleteRow($td[0],function(newTr,index){\r\n      if (newTr) {\r\n        ret = self.editor.editable.selection.setRangeAtEndOf($(newTr).find('td, th').eq(index));\r\n      }\r\n    })\r\n\r\n    return ret;\r\n  };\r\n\r\n  TableButton.prototype.insertRow = function($td, direction) {\r\n    var self = this,\r\n        ret; \r\n\r\n    tables.insertRow($td[0],direction,self.editor.editable.util.phBr,function(newTr,index){\r\n      ret =  self.editor.editable.selection.setRangeAtStartOf($(newTr).find('td, th').eq(index));\r\n    })\r\n\r\n    return ret;\r\n\r\n  };\r\n\r\n  TableButton.prototype.deleteCol = function($td) {\r\n    var self = this,\r\n        ret; \r\n\r\n    tables.deleteCol($td[0],function(newTd){\r\n      if (newTd) {\r\n        ret = self.editor.editable.selection.setRangeAtEndOf($(newTd));\r\n      }\r\n    })\r\n\r\n    return ret;\r\n  };\r\n\r\n  TableButton.prototype.insertCol = function($td, direction) {\r\n    var self = this,\r\n        ret; \r\n\r\n    tables.insertCol($td[0],direction,self.editor.editable.util.phBr,function(newTd){\r\n      ret = self.editor.editable.selection.setRangeAtStartOf($(newTd));\r\n    })\r\n\r\n    return ret;\r\n  };\r\n\r\n  TableButton.prototype.deleteTable = function($td) {\r\n    var self = this;\r\n    tables.deleteTable($td[0],function($block){\r\n      if ($block.length > 0) {\r\n        return self.editor.editable.selection.setRangeAtStartOf($block);\r\n      }\r\n    });\r\n  };\r\n\r\n  TableButton.prototype.command = function(param) {\r\n    var $td;\r\n    $td = this.editor.editable.selection.containerNode().closest('td, th');\r\n    if (!($td.length > 0)) {\r\n      return;\r\n    }\r\n    if (param === 'deleteRow') {\r\n      this.deleteRow($td);\r\n    } else if (param === 'insertRowAbove') {\r\n      this.insertRow($td, 'before');\r\n    } else if (param === 'insertRowBelow') {\r\n      this.insertRow($td);\r\n    } else if (param === 'deleteCol') {\r\n      this.deleteCol($td);\r\n    } else if (param === 'insertColLeft') {\r\n      this.insertCol($td, 'before');\r\n    } else if (param === 'insertColRight') {\r\n      this.insertCol($td);\r\n    } else if (param === 'deleteTable') {\r\n      this.deleteTable($td);\r\n    } else {\r\n      return;\r\n    }\r\n    return this.editor.trigger('valuechanged');\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(TableButton);\r\n\r\n  return TableButton;\r\n\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/TitleButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\",\r\n  \"../i18n\"\r\n],function($,Toolbar,RichEditor,Button,i18n){ \r\n  var TitleButton = Button.inherit({\r\n\r\n   });\r\n\r\n  TitleButton.prototype.name = 'title';\r\n\r\n  TitleButton.prototype.htmlTag = 'h1, h2, h3, h4, h5';\r\n\r\n  TitleButton.prototype.disableTag = 'pre, table';\r\n\r\n  TitleButton.prototype._init = function() {\r\n    this.menu = [\r\n      {\r\n        name: 'normal',\r\n        text: i18n.translate('normalText'),\r\n        param: 'p'\r\n      }, '|', {\r\n        name: 'h1',\r\n        text: i18n.translate('title') + ' 1',\r\n        param: 'h1'\r\n      }, {\r\n        name: 'h2',\r\n        text: i18n.translate('title') + ' 2',\r\n        param: 'h2'\r\n      }, {\r\n        name: 'h3',\r\n        text: i18n.translate('title') + ' 3',\r\n        param: 'h3'\r\n      }, {\r\n        name: 'h4',\r\n        text: i18n.translate('title') + ' 4',\r\n        param: 'h4'\r\n      }, {\r\n        name: 'h5',\r\n        text: i18n.translate('title') + ' 5',\r\n        param: 'h5'\r\n      }\r\n    ];\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  TitleButton.prototype.setActive = function(active, param) {\r\n    Button.prototype.setActive.call(this, active);\r\n    if (active) {\r\n      param || (param = this.node[0].tagName.toLowerCase());\r\n    }\r\n    this.el.removeClass('active-p active-h1 active-h2 active-h3 active-h4 active-h5');\r\n    if (active) {\r\n      return this.el.addClass('active active-' + param);\r\n    }\r\n  };\r\n\r\n  TitleButton.prototype.command = function(param) {\r\n    return this.editor.editable.title(param,this.disableTag);\r\n  };\r\n\r\n  RichEditor.Toolbar.addButton(TitleButton);\r\n\r\n  return TitleButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/UnderlineButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"../Button\"\r\n],function($,Toolbar,RichEditor,Button){\r\n  var UnderlineButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n  UnderlineButton.prototype.name = 'underline';\r\n\r\n  UnderlineButton.prototype.icon = 'underline';\r\n\r\n  UnderlineButton.prototype.htmlTag = 'u';\r\n\r\n  UnderlineButton.prototype.disableTag = 'pre';\r\n\r\n  UnderlineButton.prototype.shortcut = 'cmd+u';\r\n\r\n  UnderlineButton.prototype.render = function() {\r\n    if (this.editor.editable.util.os.mac) {\r\n      this.title = this.title + ' ( Cmd + u )';\r\n    } else {\r\n      this.title = this.title + ' ( Ctrl + u )';\r\n      this.shortcut = 'ctrl+u';\r\n    }\r\n    return Button.prototype.render.call(this);\r\n  };\r\n\r\n  UnderlineButton.prototype._activeStatus = function() {\r\n    var active;\r\n    active = this.editor.editable.isActive('underline');\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  UnderlineButton.prototype.command = function() {\r\n    return this.editor.editable.underline();\r\n  };\r\n\r\n\r\n  RichEditor.Toolbar.addButton(UnderlineButton);\r\n\r\n  return UnderlineButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/buttons/UnorderListButton',[\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"./ListButton\"\r\n],function($,Toolbar,RichEditor,ListButton){ \r\n   var UnorderListButton = ListButton.inherit({\r\n\r\n   });\r\n\r\n    UnorderListButton.prototype.type = 'ul';\r\n\r\n    UnorderListButton.prototype.name = 'ul';\r\n\r\n    UnorderListButton.prototype.icon = 'list-ul';\r\n\r\n    UnorderListButton.prototype.htmlTag = 'ul';\r\n\r\n    UnorderListButton.prototype.shortcut = 'cmd+.';\r\n\r\n    UnorderListButton.prototype._init = function() {\r\n      if (this.editor.editable.util.os.mac) {\r\n        this.title = this.title + ' ( Cmd + . )';\r\n      } else {\r\n        this.title = this.title + ' ( Ctrl + . )';\r\n        this.shortcut = 'ctrl+.';\r\n      }\r\n      return ListButton.prototype._init.call(this);\r\n    };\r\n\r\n    RichEditor.Toolbar.addButton(UnorderListButton);  \r\n\r\n    return UnorderListButton;\r\n\r\n});\ndefine('skylark-widgets-richeditor/main',[\r\n  \"./RichEditor\", \r\n  \"./Button\", \r\n  \"./Popover\", \r\n\r\n  \"./buttons/AlignmentButton\", \r\n  \"./buttons/BlockquoteButton\", \r\n  \"./buttons/BoldButton\", \r\n  \"./buttons/CodeButton\", \r\n  \"./buttons/CodePopover\", \r\n  \"./buttons/ColorButton\", \r\n  \"./buttons/FontScaleButton\", \r\n  \"./buttons/HrButton\", \r\n  \"./buttons/ImageButton\", \r\n  \"./buttons/ImagePopover\", \r\n  \"./buttons/IndentButton\", \r\n  \"./buttons/ItalicButton\", \r\n  \"./buttons/LinkButton\", \r\n  \"./buttons/LinkPopover\", \r\n  \"./buttons/ListButton\", \r\n  \"./buttons/OrderListButton\", \r\n  \"./buttons/OutdentButton\",\r\n  \"./buttons/StrikethroughButton\", \r\n  \"./buttons/TableButton\", \r\n  \"./buttons/TitleButton\", \r\n  \"./buttons/UnderlineButton\", \r\n  \"./buttons/UnorderListButton\"\r\n],function(RichEditor){\r\n\t\r\n  return RichEditor;\r\n});\ndefine('skylark-widgets-richeditor', ['skylark-widgets-richeditor/main'], function (main) { return main; });\n\n"]}