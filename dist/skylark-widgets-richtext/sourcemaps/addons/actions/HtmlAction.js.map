{"version":3,"sources":["addons/actions/HtmlAction.js"],"names":["define","$","addons","Action","HtmlAction","inherit","name","icon","needFocus","_init","_this","prototype","call","this","editor","textarea","on","e","el","addClass","removeClass","setValue","val","_resizeTextarea","status","_execute","i","len","ref","blur","toggleClass","htmlMode","hasClass","hidePopover","beautifyHTML","toolbar","Actions","length","setActive","setDisabled","arguments","_textareaPadding","innerHeight","height","scrollHeight","actions","html"],"mappings":";;;;;;;AAAAA,QACE,qBACA,eACA,gBACA,SAASC,EAAEC,EAAOC,GACjB,IAIIC,EAAaD,EAAOE,SACvBC,KAAO,OAEPC,KAAO,QAEPC,WAAY,EAEZC,MAAQ,WAE2B,IAAUC,EAW3C,OAZAP,EAAOQ,UAAUF,MAAMG,KAAKC,MAC5BA,KAAKC,OAAOC,SAASC,GAAG,SAAmBN,EAIxCG,KAHM,SAASI,GACd,OAAOP,EAAMI,OAAOI,GAAGC,SAAS,SAASC,YAAY,YAGzDP,KAAKC,OAAOC,SAASC,GAAG,OAAQ,SAAUN,GACxC,OAAO,SAASO,GAEd,OADAP,EAAMI,OAAOI,GAAGE,YAAY,SACrBV,EAAMI,OAAOO,SAASX,EAAMI,OAAOC,SAASO,QAHvB,CAK7BT,OACIA,KAAKC,OAAOC,SAASC,GAAG,QAAS,SAAUN,GAChD,OAAO,SAASO,GACd,OAAOP,EAAMa,mBAFuB,CAIrCV,QAGLW,OAAS,aAETC,SAAW,WACT,IAAItB,EAAQuB,EAAGC,EAAKC,EAYpB,IAXAf,KAAKC,OAAOe,OACZhB,KAAKC,OAAOI,GAAGY,YAAY,mBAC3BjB,KAAKC,OAAOiB,SAAWlB,KAAKC,OAAOI,GAAGc,SAAS,mBAC3CnB,KAAKC,OAAOiB,UACdlB,KAAKC,OAAOmB,cACZpB,KAAKC,OAAOC,SAASO,IAAIT,KAAKqB,aAAarB,KAAKC,OAAOC,SAASO,QAChET,KAAKU,mBAELV,KAAKC,OAAOO,SAASR,KAAKC,OAAOC,SAASO,OAGvCI,EAAI,EAAGC,GADZC,EAAMf,KAAKC,OAAOqB,QAAQC,SACJC,OAAQX,EAAIC,EAAKD,IAEjB,UADpBvB,EAASyB,EAAIF,IACFpB,KACTH,EAAOmC,UAAUzB,KAAKC,OAAOiB,UAE7B5B,EAAOoC,YAAY1B,KAAKC,OAAOiB,UAGnC,OAAO,MAGTG,aAAe,WACb,OAAOM,UAAU,IAUnBjB,gBAAkB,WAEhB,OADAV,KAAK4B,mBAAqB5B,KAAK4B,iBAAmB5B,KAAKC,OAAOC,SAAS2B,cAAgB7B,KAAKC,OAAOC,SAAS4B,UACrG9B,KAAKC,OAAOC,SAAS4B,OAAO9B,KAAKC,OAAOC,SAAS,GAAG6B,aAAe/B,KAAK4B,qBAQlF,OAFAvC,EAAO2C,QAAQC,KAAO1C,EAEfA","file":"../../../addons/actions/HtmlAction.js","sourcesContent":["define([\r\n  \"skylark-domx-query\",\r\n  \"../../addons\",\r\n  \"../../Action\"\r\n],function($,addons,Action){ \r\n   var  hasProp = {}.hasOwnProperty,\r\n        slice = [].slice;\r\n  \r\n\r\n   var HtmlAction = Action.inherit({\r\n    name : 'html',\r\n\r\n    icon : 'html5',\r\n\r\n    needFocus : false,\r\n\r\n    _init : function() {\r\n      Action.prototype._init.call(this);\r\n      this.editor.textarea.on('focus', (function(_this) {\r\n        return function(e) {\r\n          return _this.editor.el.addClass('focus').removeClass('error');\r\n        };\r\n      })(this));\r\n      this.editor.textarea.on('blur', (function(_this) {\r\n        return function(e) {\r\n          _this.editor.el.removeClass('focus');\r\n          return _this.editor.setValue(_this.editor.textarea.val());\r\n        };\r\n      })(this));\r\n      return this.editor.textarea.on('input', (function(_this) {\r\n        return function(e) {\r\n          return _this._resizeTextarea();\r\n        };\r\n      })(this));\r\n    },\r\n\r\n    status : function() {},\r\n\r\n    _execute : function() {\r\n      var Action, i, len, ref;\r\n      this.editor.blur();\r\n      this.editor.el.toggleClass('richeditor-html');\r\n      this.editor.htmlMode = this.editor.el.hasClass('richeditor-html');\r\n      if (this.editor.htmlMode) {\r\n        this.editor.hidePopover();\r\n        this.editor.textarea.val(this.beautifyHTML(this.editor.textarea.val()));\r\n        this._resizeTextarea();\r\n      } else {\r\n        this.editor.setValue(this.editor.textarea.val());\r\n      }\r\n      ref = this.editor.toolbar.Actions;\r\n      for (i = 0, len = ref.length; i < len; i++) {\r\n        Action = ref[i];\r\n        if (Action.name === 'html') {\r\n          Action.setActive(this.editor.htmlMode);\r\n        } else {\r\n          Action.setDisabled(this.editor.htmlMode);\r\n        }\r\n      }\r\n      return null;\r\n    },\r\n\r\n    beautifyHTML : function() {\r\n      return arguments[0];\r\n      var args;\r\n      args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\r\n      if (beautify.html) {\r\n        return beautify.html.apply(beautify, args);\r\n      } else {\r\n        return beautify.apply(null, args);\r\n      }\r\n    },\r\n\r\n    _resizeTextarea : function() {\r\n      this._textareaPadding || (this._textareaPadding = this.editor.textarea.innerHeight() - this.editor.textarea.height());\r\n      return this.editor.textarea.height(this.editor.textarea[0].scrollHeight - this._textareaPadding);\r\n    }\r\n\r\n   });\r\n\r\n\r\n   addons.actions.html = HtmlAction; \r\n\r\n   return HtmlAction;\r\n});"]}