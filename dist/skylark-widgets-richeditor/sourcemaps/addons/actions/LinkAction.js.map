{"version":3,"sources":["addons/actions/LinkAction.js"],"names":["define","$","Toolbar","RichEditor","Action","i18n","LinkPopover","LinkAction","inherit","prototype","name","icon","htmlTag","disableTag","render","args","arguments","length","Array","slice","call","apply","this","popover","_status","active","editor","editable","selection","rangeAtEndOf","node","show","hide","command","_this","one","linkText","urlEl","focus","select","textEl","link","translate","addAction"],"mappings":";;;;;;;AAAAA,QACE,qBACA,aACA,gBACA,8BACA,UACA,iBACA,SAASC,EAAEC,EAAQC,EAAWC,EAAOC,EAAKC,GAG1C,IAAIC,EAAaH,EAAOI,YAqDxB,OAhDAD,EAAWE,UAAUC,KAAO,OAE5BH,EAAWE,UAAUE,KAAO,OAE5BJ,EAAWE,UAAUG,QAAU,IAE/BL,EAAWE,UAAUI,WAAa,MAElCN,EAAWE,UAAUK,OAAS,WAC5B,IAAIC,EAGJ,OAFAA,EAAO,GAAKC,UAAUC,OAASC,MAAMT,UAAUU,MAAMC,KAAKJ,UAAW,MACrEZ,EAAOK,UAAUK,OAAOO,MAAMC,KAAMP,GAC7BO,KAAKC,QAAU,IAAIjB,GACxBF,OAAQkB,QAIZf,EAAWE,UAAUe,QAAU,WAE7B,OADDpB,EAAOK,UAAUe,QAAQJ,KAAKE,MACzBA,KAAKG,SAAWH,KAAKI,OAAOC,SAASC,UAAUC,aAAaP,KAAKQ,MAC5DR,KAAKC,QAAQQ,KAAKT,KAAKQ,MAEvBR,KAAKC,QAAQS,QAIxBzB,EAAWE,UAAUwB,QAAU,WAEK,IAAUC,EAc5C,OAfIZ,KAAKG,QACPH,KAAKC,QAAQY,IAAI,eAAyBD,EAUvCZ,KATM,WACL,OAAIc,UACFF,EAAMX,QAAQc,MAAMC,QACbJ,EAAMX,QAAQc,MAAM,GAAGE,WAE9BL,EAAMX,QAAQiB,OAAOF,QACdJ,EAAMX,QAAQiB,OAAO,GAAGD,aAOhCjB,KAAKI,OAAOC,SAASc,KAAKnB,KAAKG,OAAOpB,EAAKqC,UAAU,cAI9DvC,EAAWD,QAAQyC,UAAUpC,GAEtBA","file":"../../../addons/actions/LinkAction.js","sourcesContent":["define([\r\n  \"skylark-domx-query\",\r\n  \"../Toolbar\",\r\n  \"../RichEditor\",\r\n  \"skylark-widgets-base/Action\",\r\n  \"../i18n\",\r\n  \"./LinkPopover\"\r\n],function($,Toolbar,RichEditor,Action,i18n,LinkPopover){ \r\n  \r\n\r\n  var LinkAction = Action.inherit({\r\n\r\n   });\r\n\r\n\r\n  LinkAction.prototype.name = 'link';\r\n\r\n  LinkAction.prototype.icon = 'link';\r\n\r\n  LinkAction.prototype.htmlTag = 'a';\r\n\r\n  LinkAction.prototype.disableTag = 'pre';\r\n\r\n  LinkAction.prototype.render = function() {\r\n    var args;\r\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\r\n    Action.prototype.render.apply(this, args);\r\n    return this.popover = new LinkPopover({\r\n      Action: this\r\n    });\r\n  };\r\n\r\n  LinkAction.prototype._status = function() {\r\n   Action.prototype._status.call(this);\r\n    if (this.active && !this.editor.editable.selection.rangeAtEndOf(this.node)) {\r\n      return this.popover.show(this.node);\r\n    } else {\r\n      return this.popover.hide();\r\n    }\r\n  };\r\n\r\n  LinkAction.prototype.command = function() {\r\n    if (this.active) {\r\n      this.popover.one('popovershow', (function(_this) {\r\n        return function() {\r\n          if (linkText) {\r\n            _this.popover.urlEl.focus();\r\n            return _this.popover.urlEl[0].select();\r\n          } else {\r\n            _this.popover.textEl.focus();\r\n            return _this.popover.textEl[0].select();\r\n          }\r\n        };\r\n      })(this));\r\n\r\n    }\r\n\r\n    return this.editor.editable.link(this.active,i18n.translate('linkText'));\r\n\r\n  };\r\n\r\n  RichEditor.Toolbar.addAction(LinkAction);\r\n\r\n  return LinkAction;\r\n\r\n});"]}